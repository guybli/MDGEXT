/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.declare("fcg.mdg.approvecrv2.DomainSpecParts.CostCenterChange");jQuery.sap.require("fcg.mdg.approvecrv2.DomainSpecParts.CostCenter");fcg.mdg.approvecrv2.DomainSpecParts.CostCenterChange={oCostCenterGeneralTable:"",oCostCenterAddressTable:"",oCostCenterCommTable:"",oCostCenterIndTable:"",oCostCenterDescTable:"",aDetailData:"",nodata:"",oAttachment:"",vLinkPressed:"",oS3Controller:"",initialize_Tables:function(s){this.oS3Controller=s;sap.ui.getCore().byId("ccCreateDataLayout").removeAllContent();sap.ui.getCore().byId("ccGeneralDataLayout").removeAllContent();this.oCostCenterGeneralTable="";this.oCostCenterGeneralTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Tablereuse',this);sap.ui.getCore().byId("ccGeneralDataLayout").addContent(this.oCostCenterGeneralTable);var g=this.oCostCenterGeneralTable.getColumns();var G=new sap.m.Label({text:sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_DESCRIPTION")});g[0].setHeader(G);this.oCostCenterGeneralTable.setGrowing(true);sap.ui.getCore().byId("ccAddressLayout").removeAllContent();this.oCostCenterAddressTable="";this.oCostCenterAddressTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Tablereuse',this);sap.ui.getCore().byId("ccAddressLayout").addContent(this.oCostCenterAddressTable);var a=this.oCostCenterAddressTable.getColumns();var A=new sap.m.Label({text:sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_DESCRIPTION")});a[0].setHeader(A);this.oCostCenterAddressTable.setGrowing(true);this.oCostCenterAddressTable.setHeaderText(sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("PC_TIT_ADDRESS"));sap.ui.getCore().byId("ccCommLayout").removeAllContent();this.oCostCenterCommTable="";this.oCostCenterCommTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Tablereuse',this);sap.ui.getCore().byId("ccCommLayout").addContent(this.oCostCenterCommTable);var c=this.oCostCenterCommTable.getColumns();var C=new sap.m.Label({text:sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_DESCRIPTION")});c[0].setHeader(C);this.oCostCenterCommTable.setGrowing(true);this.oCostCenterCommTable.setHeaderText(sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("PC_TIT_COMM"));sap.ui.getCore().byId("ccIndLayout").removeAllContent();this.oCostCenterIndTable="";this.oCostCenterIndTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Tablereuse',this);sap.ui.getCore().byId("ccIndLayout").addContent(this.oCostCenterIndTable);var i=this.oCostCenterIndTable.getColumns();var I=new sap.m.Label({text:sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_DESCRIPTION")});i[0].setHeader(I);this.oCostCenterIndTable.setGrowing(true);this.oCostCenterIndTable.setHeaderText(sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_TIT_IND"));sap.ui.getCore().byId("ccDescLayout").removeAllContent();this.oCostCenterDescTable="";this.oCostCenterDescTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Tablereuse',this);sap.ui.getCore().byId("ccDescLayout").addContent(this.oCostCenterDescTable);var d=this.oCostCenterDescTable.getColumns();var D=new sap.m.Label({text:sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("PC_DESC_COL_NAME")});d[0].setHeader(D);this.oCostCenterDescTable.setGrowing(true);this.oCostCenterDescTable.setHeaderText(sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_TIT_DES"));this.oS3Controller.ccHookChangeLayout();sap.ui.getCore().byId("ccAttachmentLayout").removeAllContent();this.oAttachment="";this.oAttachment=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Tablereuse',this);sap.ui.getCore().byId("ccAttachmentLayout").addContent(this.oAttachment);var b=this.oAttachment.getColumns();var o=new sap.m.Label({text:sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_ATTACHMENT")});b[0].setHeader(o);this.oAttachment.setGrowing(true);this.oAttachment.setHeaderText(sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("PC_TIT_ATTACH"));},getDetailData:function(){return this.aDetailData;},getQueries:function(s,p,a){this.oS3Controller=a;var q=p+"?$expand=CCTR/ChangeData,CCTR/CCTR2DTxtCCTRRel/ChangeData,CCTR/CCTR2AtthCCTRRel/ChangeData,CCTR/CD_CCTRRESPU,CCTR/CD_COAREA,CCTR/CD_CCTRCGY,CCTR/CD_CCODECCTR,CCTR/CD_CCTRBAREA,CCTR/CD_FUNCCCTR,CCTR/CD_CURRCCTR,"+"CCTR/CD_CC_LAND1,CCTR/CD_CC_REGION,CCTR/CD_CC_SPRAS,CCTR/CCTR2DTxtCCTRRel/CD_LANGU,CCTR/CCTR2AtthCCTRRel/CD_USMD_ACREATED_BY,"+"CCTR/CCTR2PCTRCCTRRel,CCTR/CCTR2NEWCCTRRel";var e=this.oS3Controller.ccHookChangeQuery(q);if(e!==undefined){q=e;}return q;},displayTableData:function(r,I,v){this.aDetailData=r;var o=this.createTableTemplate();o.attachPress({Entity:r,name:'ccItemDetail'},v.navtoSubDetail,v);var g={results:[]};var a={results:[]};var c={results:[]};var b={results:[]};var e="("+sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_NOT_MAIN")+")";var d=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_DELETED");this.handleNodata(r,v);for(var i=0;i<r.CCTR.ChangeData.results.length;i++){r.CCTR.ChangeData.results[i].EntityDesc=r.CCTR.TXTSH+" ("+r.CCTR.COAREA+"/"+r.CCTR.CCTR+")";var A=r.CCTR.ChangeData.results[i].Attribute;if(A==='CCTR'||A==='COAREA'||A==='CCTRDEPT'||A==='CCTRCGY'||A==='CCODECCTR'||A==='CCTRBAREA'||A==='FUNCCCTR'||A==='CURRCCTR'||A==='PCTRCCTR'||A==='CCTRLSYS'||A==='CCTRCCTRN'||A==='CCTRRESPU'||A==='CCTRRESPP'){if(r.CCTR.ChangeData.results[i].NewValue!==r.CCTR.ChangeData.results[i].OldValue){if(r.CCTR.ChangeData.results[i].OldValue===""){r.CCTR.ChangeData.results[i].OldValue=e;}if(r.CCTR.ChangeData.results[i].OldValueText!==""){r.CCTR.ChangeData.results[i].OldValue=r.CCTR.ChangeData.results[i].OldValueText+" ("+r.CCTR.ChangeData.results[i].OldValue+")";}if(r.CCTR.ChangeData.results[i].NewValueText!==""){r.CCTR.ChangeData.results[i].NewValue=r.CCTR.ChangeData.results[i].NewValueText+" ("+r.CCTR.ChangeData.results[i].NewValue+")";}if(r.CCTR.ChangeData.results[i].NewValue===""&&r.CCTR.ChangeData.results[i].OldValue!=="")r.CCTR.ChangeData.results[i].NewValue=d;g.results.push(r.CCTR.ChangeData.results[i]);}}if(A==='CC_STRAS'||A==='CC_PSTLZ'||A==='CC_ORT01'||A==='CC_REGION'||A==='CC_ORT02'||A==='CC_LAND1'||A==='CC_PSTL2'||A==='CC_PFACH'||A==='CCTRTXJCD'||A==='CC_NAME1'||A==='CC_NAME2'||A==='CC_NAME3'||A==='CC_NAME4'||A==='CC_ANRED'){if(A==='CC_NAME1'){r.CCTR.ChangeData.results[i].AttributeDesc=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_NAME1");}if(r.CCTR.ChangeData.results[i].OldValue===""){r.CCTR.ChangeData.results[i].OldValue=e;}if(r.CCTR.ChangeData.results[i].OldValueText!==""){r.CCTR.ChangeData.results[i].OldValue=r.CCTR.ChangeData.results[i].OldValueText+" ("+r.CCTR.ChangeData.results[i].OldValue+")";}if(r.CCTR.ChangeData.results[i].NewValueText!==""){r.CCTR.ChangeData.results[i].NewValue=r.CCTR.ChangeData.results[i].NewValueText+" ("+r.CCTR.ChangeData.results[i].NewValue+")";}if(r.CCTR.ChangeData.results[i].NewValue===""&&r.CCTR.ChangeData.results[i].OldValue!=="")r.CCTR.ChangeData.results[i].NewValue=d;a.results.push(r.CCTR.ChangeData.results[i]);}if(A==='CC_SPRAS'||A==='CC_TELF1'||A==='CC_TELF2'||A==='CC_TELFX'||A==='CC_TELBX'||A==='CC_TELX1'||A==='CC_TELTX'||A==='CC_DRNAM'||A==='CC_DATLT'){if(r.CCTR.ChangeData.results[i].OldValue===""){r.CCTR.ChangeData.results[i].OldValue=e;}if(r.CCTR.ChangeData.results[i].OldValueText!==""){r.CCTR.ChangeData.results[i].OldValue=r.CCTR.ChangeData.results[i].OldValueText+" ("+r.CCTR.ChangeData.results[i].OldValue+")";}if(r.CCTR.ChangeData.results[i].NewValueText!==""){r.CCTR.ChangeData.results[i].NewValue=r.CCTR.ChangeData.results[i].NewValueText+" ("+r.CCTR.ChangeData.results[i].NewValue+")";}if(r.CCTR.ChangeData.results[i].NewValue===""&&r.CCTR.ChangeData.results[i].OldValue!=="")r.CCTR.ChangeData.results[i].NewValue=d;c.results.push(r.CCTR.ChangeData.results[i]);}if(A==='CCTRQTYRQ'||A==='CCTRLKAPP'||A==='CCTRLKASC'||A==='CCTRLKPPC'||A==='CCTRLKPSC'||A==='CCTRLKARP'||A==='CCTRLKPRV'||A==='CCTRLKCUP'){r.CCTR.ChangeData.results[i]=r.CCTR.ChangeData.results[i];if(r.CCTR.ChangeData.results[i].NewValue==='X')r.CCTR.ChangeData.results[i].NewValue=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_YES");else if(r.CCTR.ChangeData.results[i].NewValue==="")r.CCTR.ChangeData.results[i].NewValue=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_NO");if(r.CCTR.ChangeData.results[i].OldValue==='X')r.CCTR.ChangeData.results[i].OldValue=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_YES");else if(r.CCTR.ChangeData.results[i].OldValue==="")r.CCTR.ChangeData.results[i].OldValue=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_NO");b.results.push(r.CCTR.ChangeData.results[i]);}}this.bindDescriptionTable(r,v,o);this.oS3Controller.ccHookFillDataForChangeLayout(r,v);var m=this.oS3Controller.ccHookModifyChangeData(g,a,c,b,r);if(m!==undefined){g=m.aGenData;a=m.aAddress;c=m.aCommData;b=m.aIndicators;}this.bindFormData(g,a,c,b,o);this.createCctrAttachmentTable(r,v);},bindFormData:function(g,a,c,i,I){if(g.results.length===0){sap.ui.getCore().byId("ccGeneralDataLayout").removeAllContent();if(this.nodata==='X'){var t=new sap.m.Text("ccTxt");t.setText(sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("Nodata"));sap.ui.getCore().byId("ccGeneralDataLayout").addContent(t);this.nodata="";}}else{var G=new sap.ui.model.json.JSONModel();G.setData(g);this.oCostCenterGeneralTable.setModel(G);this.oCostCenterGeneralTable.bindItems('/results',I,'','');}if(a.results.length===0){sap.ui.getCore().byId("ccAddressLayout").removeAllContent();sap.ui.getCore().byId("ccAddressLayout").destroy();}else{var A=new sap.ui.model.json.JSONModel();A.setData(a);this.oCostCenterAddressTable.setModel(A);this.oCostCenterAddressTable.bindItems('/results',I,'','');}if(c.results.length===0){sap.ui.getCore().byId("ccCommLayout").removeAllContent();sap.ui.getCore().byId("ccCommLayout").destroy();}else{var C=new sap.ui.model.json.JSONModel();C.setData(c);this.oCostCenterCommTable.setModel(C);this.oCostCenterCommTable.bindItems('/results',I,'','');}if(i.results.length===0){sap.ui.getCore().byId("ccIndLayout").removeAllContent();sap.ui.getCore().byId("ccIndLayout").destroy();}else{var o=new sap.ui.model.json.JSONModel();o.setData(i);this.oCostCenterIndTable.setModel(o);this.oCostCenterIndTable.bindItems('/results',I,'','');}},bindDescriptionTable:function(r,v,I){var s={results:[]};var d=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_DELETED");var e="("+sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_NOT_MAIN")+")";for(var i=0;i<r.CCTR.CCTR2DTxtCCTRRel.results.length;i++){if(r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results.length>0){for(var j=0;j<r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results.length;j++){var D={EntityDesc:"",AttributeDesc:"",NewValue:"",OldValue:""};if(r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].Attribute!=='CCTR'&&r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].Attribute!=='COAREA'&&r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].Attribute!=='LANGU'){D.EntityDesc=r.CCTR.CCTR2DTxtCCTRRel.results[i].TXTSH+" ("+r.CCTR.CCTR2DTxtCCTRRel.results[i].CD_LANGU.Description+")";if(r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].EntityAction==='C'){D.NewValue=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_ADDED");s.results.push(D);break;}else if(r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].EntityAction==='D'){D.NewValue=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_DELETED");s.results.push(D);break;}else{if(r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].Attribute==='TXTSH'){D.AttributeDesc=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("FIN_SHORT_TEXT");}else if(r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].Attribute==='TXTMI'){D.AttributeDesc=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_MED_TEXT");}else{D.AttributeDesc=r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].AttributeDesc;}D.NewValue=r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].NewValue;if(r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].OldValue===""){D.OldValue=e;}else{D.OldValue=r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].OldValue;}if(r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].NewValue===""&&r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].OldValue!=="")D.NewValue=d;else if(r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].NewValue!=="")D.NewValue=r.CCTR.CCTR2DTxtCCTRRel.results[i].ChangeData.results[j].NewValue;s.results.push(D);}}}}}var E=this.oS3Controller.ccHookDecTempForChange(I);if(E!==undefined){I=E;}if(s.results.length===0){sap.ui.getCore().byId("ccDescLayout").removeAllContent();sap.ui.getCore().byId("ccDescLayout").destroy();}else{var m=new sap.ui.model.json.JSONModel();m.setData(s);this.oCostCenterDescTable.setModel(m);this.oCostCenterDescTable.bindItems('/results',I,'','');}},createTableTemplate:function(){var i=new sap.m.ColumnListItem({type:"Navigation",cells:[new sap.m.Text({text:"{EntityDesc}"}).addStyleClass("text_bold"),new sap.m.ObjectIdentifier({text:{path:"AttributeDesc"},title:{path:"NewValue"}}),new sap.m.Text({text:{path:"OldValue"}})]});return i;},handleNodata:function(r){var n="X",a="X",b="X";if(r.CCTR.ChangeData.results.length!==0){n="";}for(var i=0;i<r.CCTR.CCTR2AtthCCTRRel.results.length;i++){if(r.CCTR.CCTR2AtthCCTRRel.results[i].ChangeData.results.length!==0){a="";break;}}for(var j=0;j<r.CCTR.CCTR2DTxtCCTRRel.results.length;j++){if(r.CCTR.CCTR2DTxtCCTRRel.results[j].ChangeData.results.length!==0){b="";break;}}if(n==='X'&&a==='X'&&b==='X'){this.nodata='X';}},createCctrAttachmentTable:function(r,v){var o="";var n="";var N="";this.oAttachment.attachItemPress({Entity:r,name:'ccItemDetail'},v.navtoSubDetail,v);for(var i=0;i<r.CCTR.CCTR2AtthCCTRRel.results.length;i++){for(var j=0;j<r.CCTR.CCTR2AtthCCTRRel.results[i].ChangeData.results.length;j++){var g=this;var l="";if(r.CCTR.CCTR2AtthCCTRRel.results[i].ChangeData.results[j].EntityAction!=='D'){if(r.CCTR.CCTR2AtthCCTRRel.results[i].USMD_LINK!=="")l=r.CCTR.CCTR2AtthCCTRRel.results[i].USMD_LINK;else l=r.CCTR.CCTR2AtthCCTRRel.results[i].__metadata.media_src;}var a=new sap.m.Link({text:r.CCTR.CCTR2AtthCCTRRel.results[i].USMD_TITLE,target:"_blank",href:l,wrapping:true,subtle:false,emphasized:false,press:function(){g.setLinkPress('X');}}).addStyleClass("padding_bottom");var f=fcg.mdg.approvecrv2.util.Formatter.dateFormatter(r.CCTR.CCTR2AtthCCTRRel.results[i].USMD_ACREATED_AT)+" "+sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText('AttachBy')+" ";var c=" "+r.CCTR.CCTR2AtthCCTRRel.results[i].CD_USMD_ACREATED_BY.Description+"("+r.CCTR.CCTR2AtthCCTRRel.results[i].CD_USMD_ACREATED_BY.Code+")";var C=new sap.m.Text({text:f+" "+c});var I=fcg.mdg.approvecrv2.util.Formatter.mimeTypeFormatter(r.CCTR.CCTR2AtthCCTRRel.results[i].USMD_FILE_TYPE);var b=new sap.ui.layout.VerticalLayout({content:[a,C]}).addStyleClass("padding_left");I=new sap.ui.core.Icon({src:I,size:"3.0em"});var h=new sap.m.HBox({items:[I,b]});if(r.CCTR.CCTR2AtthCCTRRel.results[i].ChangeData.results[j].EntityAction==='C'){N=new sap.m.ObjectIdentifier({text:" ",title:sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_ADDED")});var O=new sap.m.Text({text:""});var L=new sap.m.ColumnListItem({type:"Navigation",mergeDuplicates:true,cells:[h,N,O]});this.oAttachment.addItem(L);break;}else if(r.CCTR.CCTR2AtthCCTRRel.results[i].ChangeData.results[j].EntityAction==='D'){N=new sap.m.ObjectIdentifier({text:" ",title:sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_DELETED")});var O=new sap.m.Text({text:""});var L=new sap.m.ColumnListItem({type:"Navigation",mergeDuplicates:true,cells:[h,N,O]});this.oAttachment.addItem(L);break;}else{if(r.CCTR.CCTR2AtthCCTRRel.results[i].ChangeData.results[j].Attribute==='USMD_EXPL'||r.CCTR.CCTR2AtthCCTRRel.results[i].ChangeData.results[j].Attribute==='USMD_LANG'){if(r.CCTR.CCTR2AtthCCTRRel.results[i].ChangeData.results[j].OldValue===""){o="("+sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_NOT_MAIN")+")";}else{o=r.CCTR.CCTR2AtthCCTRRel.results[i].ChangeData.results[j].OldValue;}if(r.CCTR.CCTR2AtthCCTRRel.results[i].ChangeData.results[j].NewValue===""&&r.CCTR.CCTR2AtthCCTRRel.results[i].ChangeData.results[j].OldValue!=="")n=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_DELETED");else if(r.CCTR.CCTR2AtthCCTRRel.results[i].ChangeData.results[j].NewValue!=="")n=r.CCTR.CCTR2AtthCCTRRel.results[i].ChangeData.results[j].NewValue;if(r.CCTR.CCTR2AtthCCTRRel.results[i].ChangeData.results[j].Attribute==='USMD_EXPL')var A=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("ATTACH_COMMENT");else A=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("Language");N=new sap.m.ObjectIdentifier({text:A,title:n});O=new sap.m.Text({text:o});L=new sap.m.ColumnListItem({type:"Navigation",mergeDuplicates:true,cells:[h,N,O]});this.oAttachment.addItem(L);}}}}if(this.oAttachment.getItems().length===0){sap.ui.getCore().byId("ccAttachmentLayout").removeAllContent();sap.ui.getCore().byId("ccAttachmentLayout").destroy();}},setLinkPress:function(v){this.vLinkPressed=v;},getLinkPress:function(){return this.vLinkPressed;}};
