/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.declare("fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialBasicDataChange");jQuery.sap.require("fcg.mdg.approvecrv2.util.DataAccess");fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialBasicDataChange={oGeneralTable:"",omatDimTable:"",omatClassTable:"",omatPurchTable:"",omatIntComntNotesTable:"",omatBasicTxtNotesTable:"",aClassificationDetailData:"",omatDescNotesTable:"",omatPurchONotesTable:"",omatQualityInsNotesTable:"",oS3Controller:"",oGeneralChangedPanelData:"",materialheader1:"",unitmsraddedflag:0,unitmsrdeletedflag:0,vGtinflag:0,vgtinflag:0,vVaidFromflag:0,aNetWeightData:"",aIntDetComntNotesData:{results:[]},i18n:sap.ca.scfld.md.app.Application.getImpl().getResourceBundle(),aBasicTxtDetNotesData:{results:[]},aDescDetNotesData:{results:[]},aQualityInsDetNotesData:{results:[]},ostrResults:{dataitems:[]},aGtinSortedData:{results:[]},aGtinChangedResponse:{results:[]},aGtinDetData:{results:[]},aNotesDetailData:"",oItemTemp:"",vUomChngData:"",aGrossWeightData:"",initialize_General_Tables:function(s){this.aClassificationDetailData="";this.oS3Controller=s;sap.ui.getCore().byId("materialChangedDataLayout").removeAllContent();sap.ui.getCore().byId("materialChangedDataLayout").removeAllContent();var p=fcg.mdg.approvecrv2.util.Formatter.getMatVisibiltyBasedOnParameter('E');if(p===false){if(sap.ui.getCore().byId("matPurchasingChangedPanel")!==undefined){sap.ui.getCore().byId("matPurchasingChangedPanel").destroy();}}var c=fcg.mdg.approvecrv2.util.Formatter.getMatVisibiltyBasedOnParameter('C');if(c===false){if(sap.ui.getCore().byId("matClassificationChangedPanel")!==undefined){sap.ui.getCore().byId("matClassificationChangedPanel").destroy();}}sap.ui.getCore().byId("materialChangedDataLayout").removeAllContent();this.oGeneralTable="";this.oGeneralTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MatChangeTableReuse',this);sap.ui.getCore().byId("materialChangedDataLayout").addContent(this.oGeneralTable);if(sap.ui.getCore().byId("materialDataLayout")!==undefined){sap.ui.getCore().byId("materialDataLayout").destroy();}sap.ui.getCore().byId("matGtinChangedPanel").attachExpand("",s.onPanelExpand,s);if(sap.ui.getCore().byId("matClassificationChangedPanel")!==undefined){sap.ui.getCore().byId("matClassificationChangedPanel").attachExpand("",s.onPanelExpand,s);}if(sap.ui.getCore().byId("matPurchasingChangedPanel")!==undefined){sap.ui.getCore().byId("matPurchasingChangedPanel").attachExpand("",s.onPanelExpand,s);}sap.ui.getCore().byId("matNotesChangedPanel").attachExpand("",s.onPanelExpand,s);},InitializePanelData:function(r,p,v){var n=this.i18n.getText("Nodata");var i,j;switch(p){case"matGtinChangedPanel":this.getSetGtinData(r,v,n);break;case"matClassificationChangedPanel":this.getSetClassificationChangedData(r,p,v);break;case"matPurchasingChangedPanel":sap.ui.getCore().byId("matPurchasingChangedPanel").destroyContent();this.omatPurchTable="";this.omatPurchTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MatChangeTableReuse',this);sap.ui.getCore().byId("matPurchasingChangedPanel").addContent(this.omatPurchTable);this.omatPurchTable.setGrowing(true);var I=this.createTableTemplate();I.attachPress({name:'matPurchChangedDetail'},v.navtoSubDetail,v);var P={results:[]};var g=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getGeneralDetailData();var M=g.data.TXTMI;var a=this.i18n.getText("MATERIAL");if(r.length>0){if(r[0].data.ChangeData.results.length>0||r[1].data.ChangeData.results.length>0){for(j=0;j<r.length;j++){for(i=0;i<r[j].data.ChangeData.results.length;i++){A=r[j].data.ChangeData.results[i].Attribute;if(A==='BSTME'||A==='VABME'||A==='EKWSL'||A==='MFRPN'||A==='MPROF'||A==='MFRNR'||A==='QMPUR'||A==='RBNRM'){if(A==='MFRNR'){r[j].data.ChangeData.results[i].OldValue=fcg.mdg.approvecrv2.util.Formatter.removeLeadingZeros(r[j].data.ChangeData.results[i].OldValue);r[j].data.ChangeData.results[i].NewValue=fcg.mdg.approvecrv2.util.Formatter.removeLeadingZeros(r[j].data.ChangeData.results[i].NewValue);}if(A==='VABME'){if(r[j].data.ChangeData.results[i].OldValue===""&&r[j].data.ChangeData.results[i].OldValueText!==""){r[j].data.ChangeData.results[i].OldValue=r[j].data.ChangeData.results[i].OldValueText;r[j].data.ChangeData.results[i].OldValueText="";}if(r[j].data.ChangeData.results[i].NewValue===""&&r[j].data.ChangeData.results[i].NewValueText!==""){r[j].data.ChangeData.results[i].NewValue=r[j].data.ChangeData.results[i].NewValueText;r[j].data.ChangeData.results[i].NewValueText="";}}if(r[j].data.ChangeData.results[i].NewValue!==r[j].data.ChangeData.results[i].OldValue){r[j].data.ChangeData.results[i].OldValue=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(r[j].data.ChangeData.results[i].OldValue,r[j].data.ChangeData.results[i].OldValueText);r[j].data.ChangeData.results[i].NewValue=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(r[j].data.ChangeData.results[i].NewValue,r[j].data.ChangeData.results[i].NewValueText);if(r[j].data.ChangeData.results[i].NewValue===""&&r[j].data.ChangeData.results[i].OldValue!==""){r[j].data.ChangeData.results[i].NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeletedAttributeString();}if(r[j].data.ChangeData.results[i].OldValue===""){r[j].data.ChangeData.results[i].OldValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getNotMaintString();}r[j].data.MATERIAL=fcg.mdg.approvecrv2.util.Formatter.removeLeadingZeros(r[j].data.MATERIAL);r[j].data.ChangeData.results[i].ChangeKey=M+" "+"("+r[j].data.MATERIAL+")";r[j].data.ChangeData.results[i].Entity=a;P.results.push(r[j].data.ChangeData.results[i]);}}}}}for(var j=0;j<g.data.ChangeData.results.length;j++){var A=g.data.ChangeData.results[j].Attribute;if(A==='NRFHG'){if(g.data.ChangeData.results[j].NewValue!==g.data.ChangeData.results[j].OldValue){if(g.data.ChangeData.results[j].OldValue===""&&g.data.ChangeData.results[j].OldValueText!==""){g.data.ChangeData.results[j].OldValue=g.data.ChangeData.results[j].OldValueText;g.data.ChangeData.results[j].OldValueText="";}if(g.data.ChangeData.results[j].NewValue===""&&g.data.ChangeData.results[j].NewValueText!==""){g.data.ChangeData.results[j].NewValue=g.data.ChangeData.results[j].NewValueText;g.data.ChangeData.results[j].NewValueText="";}g.data.ChangeData.results[j].Entity="";if(g.data.ChangeData.results[j].OldValue===""&&g.data.ChangeData.results[j].OldValueText===""){g.data.ChangeData.results[j].OldValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getNotMaintString();}g.data.ChangeData.results[j].OldValue=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(g.data.ChangeData.results[j].OldValue,g.data.ChangeData.results[j].OldValueText);g.data.ChangeData.results[j].NewValue=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(g.data.ChangeData.results[j].NewValue,g.data.ChangeData.results[j].NewValueText);if(g.data.ChangeData.results[j].OldValueText!==""&&g.data.ChangeData.results[j].OldValue===""){g.data.ChangeData.results[j].OldValue=g.data.ChangeData.results[j].OldValueText;}if(g.data.ChangeData.results[j].NewValue===""&&g.data.ChangeData.results[j].OldValue!==""||g.data.ChangeData.results[j].EntityAction===fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeleteEntityAction()){g.data.ChangeData.results[j].NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeletedAttributeString();}g.data.MATERIAL=fcg.mdg.approvecrv2.util.Formatter.removeLeadingZeros(g.data.MATERIAL);g.data.ChangeData.results[j].ChangeKey=M+" "+"("+g.data.MATERIAL+")";g.data.ChangeData.results[j].Entity=a;P.results.push(g.data.ChangeData.results[j]);}}}if(P.results.length>0){var o=new sap.ui.model.json.JSONModel();o.setData(P);this.omatPurchTable.setModel(o);this.omatPurchTable.bindItems('/results',I,'','');}else{var b=sap.ui.getCore().byId("matPurchasingChangedPanel");fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialCreate.setNoDataText(b,n);}}break;case"matNotesChangedPanel":this.getSetNotesChangedData(r,p,v);break;}this.oS3Controller.matHookModifyBindPanelChangedData(r,p,v);},getNotestChangeData:function(){return this.aNotesDetailData;},getClassificationChangeData:function(){return this.aClassificationDetailData;},getInstance:function(){return this;},displayGeneralTabData:function(r,i,v){if(r.data.MATERIAL2MATCHGMNGRel.results.length>0){if(r.data.MATERIAL2MATCHGMNGRel.results[0].VALID_FROM!==""&&r.data.MATERIAL2MATCHGMNGRel.results[0].VALID_FROM!==null){var V=r.data.MATERIAL2MATCHGMNGRel.results[0].VALID_FROM;r.data.MATERIAL2MATCHGMNGRel.results[0].VALID_FROM=fcg.mdg.approvecrv2.util.Formatter.matDateFormat(V);}if(r.data.MATERIAL2MATCHGMNGRel.results[0].ECOCHGMNG!==""){r.data.MATERIAL2MATCHGMNGRel.results[0].ECOCHGMNG=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(r.data.MATERIAL2MATCHGMNGRel.results[0].ECOCHGMNG,r.data.MATERIAL2MATCHGMNGRel.results[0].ECOCHGMNG__TXT);}var C=new sap.ui.model.json.JSONModel();C.setData(r.data.MATERIAL2MATCHGMNGRel.results[0]);sap.ui.getCore().byId("matchngmgmtchngForm").setModel(C);this.hideChngmgmtSection();}else{sap.ui.getCore().byId("materialchgmngLayout").destroy();}var I=this.createTableTemplate();I.attachPress({name:'matGenChangedDetail'},v.navtoSubDetail,v);var g={results:[]};this.aNetWeightData="";this.aGrossWeightData="";for(var j=0;j<r.data.ChangeData.results.length;j++){var a=r.data.ChangeData.results[j].Attribute;if(a==='NTGEW'){this.aNetWeightData="";this.aNetWeightData=$.extend(true,{},r.data.ChangeData.results[j]);}if(a==='GROES'){this.aGrossWeightData="";this.aGrossWeightData=$.extend(true,{},r.data.ChangeData.results[j]);}if(a==='MATERIAL'||a==='MEINS'||a==='MTART'||a==='MBRSH'||a==='MATKL'||a==='BISMT'||a==='BEGRU'||a==='MSTAE'||a==='MSTDE'||a==='XCHPFMARA'||a==='XGCHPMARA'||a==='SPART'||a==='KOSCH'||a==='EXTWG'||a==='PRDHA'||a==='MTPOSMARA'||a==='MAGRVMARA'||a==='LABOR'||a==='NORMT'||a==='WRKST'||a==='FERTH'||a==='FORMT'||a==='CADKZ'||a==='SATNR'||a==='KZKFG'||a==='KZUMW'||a==='PROFL'||a==='XCHPFMARA'||a==='XGCHPMARA'||a==='SPART'||a==='KOSCH'||a==='EXTWG'||a==='PRDHA'||a==='SERLV'||a==='MTPOSMARA'||a==='MAGRVMARA'||a==='LABOR'){if(a==="MEINS"){this.vUomChngData="";this.vUomChngData=r.data.ChangeData.results[j];}if(a==='SATNR'){r.data.ChangeData.results[j].OldValue=fcg.mdg.approvecrv2.util.Formatter.removeLeadingZeros(r.data.ChangeData.results[j].OldValue);r.data.ChangeData.results[j].NewValue=fcg.mdg.approvecrv2.util.Formatter.removeLeadingZeros(r.data.ChangeData.results[j].NewValue);}if(a==='SERLV'){if(r.data.ChangeData.results[j].OldValueText!==""&&r.data.ChangeData.results[j].OldValue===""){r.data.ChangeData.results[j].OldValue=r.data.ChangeData.results[j].OldValueText;r.data.ChangeData.results[j].OldValueText="";}if(r.data.ChangeData.results[j].NewValueText!==""&&r.data.ChangeData.results[j].NewValue===""){r.data.ChangeData.results[j].NewValue=r.data.ChangeData.results[j].NewValueText;r.data.ChangeData.results[j].NewValueText="";}}if(a==='MSTDE'){r.data.ChangeData.results[j].NewValue=this.FormatDateNewVal(r.data.ChangeData.results[j].NewValue);r.data.ChangeData.results[j].OldValue=this.FormatDateOldVal(r.data.ChangeData.results[j].OldValue);}if(r.data.ChangeData.results[j].NewValue!==r.data.ChangeData.results[j].OldValue){r.data.ChangeData.results[j].Entity="";if(r.data.ChangeData.results[j].OldValue===""){r.data.ChangeData.results[j].OldValueText="";r.data.ChangeData.results[j].OldValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getNotMaintString();}r.data.ChangeData.results[j].OldValue=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(r.data.ChangeData.results[j].OldValue,r.data.ChangeData.results[j].OldValueText);r.data.ChangeData.results[j].NewValue=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(r.data.ChangeData.results[j].NewValue,r.data.ChangeData.results[j].NewValueText);if(r.data.ChangeData.results[j].NewValue===""&&r.data.ChangeData.results[j].OldValue!==""||r.data.ChangeData.results[j].EntityAction===fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeleteEntityAction()){r.data.ChangeData.results[j].NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeletedAttributeString();}}r.data.ChangeData.results[j].ChangeKey=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(r.data.MATERIAL,r.data.TXTMI);g.results.push(r.data.ChangeData.results[j]);}}if(g.results.length>0){var G=new sap.ui.model.json.JSONModel();G.setData(g);this.oGeneralTable.setModel(G);this.oGeneralTable.bindItems('/results',I,'','');}else{if(sap.ui.getCore().byId("materialChangedDataLayout")!==undefined){sap.ui.getCore().byId("materialChangedDataLayout").destroy();}}},createTableTemplate:function(){var i=new sap.m.ColumnListItem({type:"Navigation",cells:[new sap.m.ObjectIdentifier({title:{path:"ChangeKey"},text:{path:"Entity"}}),new sap.m.ObjectIdentifier({text:{path:"AttributeDesc"},title:{path:"NewValue"}}),new sap.m.Text({text:{path:"OldValue"}})]});return i;},createClassTableTemplate:function(){var i=new sap.m.ColumnListItem({type:"Navigation",cells:[new sap.m.ObjectIdentifier({title:{path:"ChangeKey"},text:{path:"Entity"}}),new sap.m.ObjectIdentifier({text:{path:"AttributeDesc"},title:{path:"NewValue"}}),new sap.m.Text({text:{path:"OldValue"}})]});var e=this.oS3Controller.matHookgetClassTableTemplate(i);if(e!==undefined){i=e;}return i;},getoldValueZeroes:function(o){var O=fcg.mdg.approvecrv2.util.Formatter.defaultValue(o);if(O===false){o=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getNotMaintString();}return o;},getnewValueZeroes:function(n){var N=fcg.mdg.approvecrv2.util.Formatter.defaultValue(n);if(N===false){n=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeletedAttributeString();}return n;},getGtinDetailData:function(){return this.ostrResults;},getGtinChangedData:function(){return this.aGtinChangedResponse;},getIntComntData:function(){return this.aIntComntDetNotesData;},getBasicTxtData:function(){return this.aBasicTxtDetNotesData;},getDescData:function(){return this.aDescDetNotesData;},getQualityInsData:function(){return this.aQualityInsDetNotesData;},getSetGtinData:function(r,v,n){var n=this.i18n.getText("Nodata");var i,j,k,l,a,N,o,b,O,c,d,U,e,E,A;var g={results:[]};var D={EntityDesc:"",EntityName:"",AttributeDesc:"",NewValue:"",OldValue:"",NewValueText:"",OldValueText:"",ChangeKey:"",Entity:"",UnitOfMeasure:""};var s=["BRGEW","LAENG","BREIT","HOEHE","VOLUM","GROES","NTGEW","UMREZ","UMREN","GTIN_VAR2","EAN_MARM","MEABM","VOLEH","GEWEI"];var f=["BRGEW","LAENG","BREIT","HOEHE","VOLUM"];var h=["HPEAN","EANTP_MEA"];var m=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getGeneralDetailData();var u=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results;var M=r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results;if(u.length>0||M.length>0||m!==undefined){this.oItemTemp=this.createTableTemplate();this.ostrResults=fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialCreate.getGtinData(r);var p=this.i18n.getText("Mat_Unit_Measure");var q=this.i18n.getText("Mat_UPC");var C=p+","+" "+q;for(i=0;i<this.ostrResults.dataitems.length;i++){c=this.ostrResults.dataitems[i].unitofmeasure_txt;U=this.ostrResults.dataitems[i].unitofmeasure;d=c+" "+"("+this.ostrResults.dataitems[i].unitofmeasure+")";E=this.ostrResults.dataitems[i].eanupc;this.unitmsraddedflag=0;this.unitmsrdeletedflag=0;for(j=0;j<u.length;j++){if(u[j].QTEUNIT__TXT+" "+"("+u[j].QTEUNIT+")"===d&&u[j].EAN_MARM===E){var t=u[j].ChangeData.results;for(k=0;k<t.length;k++){if(this.unitmsraddedflag===0&&this.unitmsrdeletedflag===0){a=t[k].Attribute;N=t[k].NewValue;o=t[k].OldValue;O=t[k].OldValueText;b=t[k].NewValueText;A=t[k].AttributeDesc;if(s.indexOf(a)!==-1){if(E===""){D.ChangeKey=d;D.Entity=p;D.UnitOfMeasure=U;}else{D.ChangeKey=d+","+" "+E;D.Entity=C;D.UnitOfMeasure=U;}switch(t[0].EntityAction){case fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getCreateEntityAction():D.NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getAddedInstanceString();D.OldValue="";D.AttributeDesc="";this.unitmsraddedflag=1;break;case fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeleteEntityAction():D.NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeletedInstanceString();D.OldValue="";D.AttributeDesc="";this.unitmsrdeletedflag=1;break;case fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getUpdateEntityAction():D.NewValue=N;D.OldValue=o;D.AttributeDesc=A;D.NewValueText=b;D.OldValueText=O;if(f.indexOf(a)!==-1){D.OldValue=this.getoldValueZeroes(o);D.NewValue=this.getnewValueZeroes(N);if(D.OldValue!==""&&D.OldValue!=="("+this.i18n.getText("PC_NOT_MAIN")+")"){D.OldValue=o+" "+O;D.OldValueText="";}else{D.OldValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getNotMaintString();D.OldValueText="";}if(D.NewValue!==""){D.NewValue=N+" "+b;D.NewValueText="";}else{D.NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeletedAttributeString();D.NewValueText="";}}if(D.OldValueText!==""){D.OldValue=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(o,O);}if(D.NewValueText!==""){D.NewValue=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(N,b);}if(N===""&&o!==""){D.NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeletedAttributeString();}if(N!==""&&o===""){D.OldValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getNotMaintString();}break;}var G=$.extend(true,{},D);g.results.push(G);}}}var B=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(m.data.MEINS,m.data.MEINS__TXT);var w=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(this.ostrResults.dataitems[i].unitofmeasure,this.ostrResults.dataitems[i].unitofmeasure_txt);var x=this.ostrResults.dataitems[i].eanupc;if(w===B){if(this.unitmsraddedflag===0&&this.unitmsrdeletedflag===0){if(this.aGrossWeightData!==""){var y=$.extend(true,{},this.aGrossWeightData);var z=this.getChangedWeightData(y,x,w,p,C,U);g.results.push(z);}}if(this.unitmsraddedflag===0&&this.unitmsrdeletedflag===0){if(this.aNetWeightData!==""){var F=$.extend(true,{},this.aNetWeightData);var H=this.getChangedWeightData(F,x,w,p,C,U);g.results.push(H);}}}}}D=[];}for(i=0;i<this.ostrResults.dataitems.length;i++){c=this.ostrResults.dataitems[i].unitofmeasure_txt;U=this.ostrResults.dataitems[i].unitofmeasure;d=c+" "+"("+this.ostrResults.dataitems[i].unitofmeasure+")";E=this.ostrResults.dataitems[i].eanupc;for(j=0;j<M.length;j++){this.vgtinflag=0;if(d===M[j].QTEUNIT__TXT+" "+"("+M[j].QTEUNIT+")"&&E===M[j].EAN){var I=M[j].ChangeData.results;for(k=0;k<I.length;k++){if(this.vgtinflag===0){a=I[k].Attribute;o=I[k].OldValue;O=I[k].OldValueText;N=I[k].NewValue;b=I[k].NewValueText;if(h.indexOf(a)!==-1){if(E===""){D.ChangeKey=d;D.Entity=p;D.UnitOfMeasure=U;}else{D.ChangeKey=d+","+" "+E;D.Entity=C;D.UnitOfMeasure=U;}this.vGtinDimPresentFlag=0;var J;for(l=0;l<g.results.length;l++){if(g.results[l].ChangeKey===D.ChangeKey){this.vGtinDimPresentFlag=1;J=g.results[l].NewValue;}}if(this.vGtinDimPresentFlag===1&&J!=="Added"&&J!=="Deleted"){switch(I[0].EntityAction){case fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getCreateEntityAction():if(o===""){D.OldValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getNotMaintString();D.OldValueText="";D.NewValue=I[k].NewValue;D.NewValueText=I[k].NewValueText;D.AttributeDesc=I[k].AttributeDesc;}break;case fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeleteEntityAction():D.NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeletedAttributeString();D.NewValueText="";D.OldValue=I[k].OldValue;D.OldValueText=I[k].OldValueText;D.AttributeDesc=I[k].AttributeDesc;break;case fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getUpdateEntityAction():D.NewValue=N;D.OldValue=o;D.AttributeDesc=A;D.NewValueText=b;D.OldValueText=O;break;}if(D.OldValueText!==""){D.OldValue=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(o,O);}if(D.NewValueText!==""){D.NewValue=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(N,b);}var K=$.extend(true,{},D);g.results.push(K);}else if(this.vGtinDimPresentFlag===0){switch(I[0].EntityAction){case fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getCreateEntityAction():D.NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getAddedInstanceString();D.OldValue="";D.AttributeDesc="";this.vgtinflag=1;break;case fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeleteEntityAction():D.NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeletedInstanceString();D.OldValue="";D.AttributeDesc="";this.vgtinflag=1;break;}var K=$.extend(true,{},D);g.results.push(K);}}}}}}}this.aGtinDetData=g;this.aGtinChangedResponse=this.aGtinDetData;if(this.aGtinChangedResponse.results.length>0){sap.ui.getCore().byId("matGtinChangedPanel").destroyContent();this.omatDimTable="";this.omatDimTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MatChangeTableReuse',this);sap.ui.getCore().byId("matGtinChangedPanel").addContent(this.omatDimTable);this.omatDimTable.setGrowing(true);this.oItemTemp.attachPress({name:'matDimGtinChangedDetail'},v.navtoSubDetail,v);var L=new sap.ui.model.json.JSONModel();L.setData(this.aGtinDetData);this.omatDimTable.setModel(L);var P=new sap.ui.model.Sorter('ChangeKey');this.omatDimTable.bindItems('/results',this.oItemTemp,P,'');this.aGtinSortedData={results:[]};this.aGtinDetData={results:[]};}else{var Q=sap.ui.getCore().byId("matGtinChangedPanel");fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialCreate.setNoDataText(Q,n);}}},hideChngmgmtSection:function(){if(sap.ui.getCore().byId("Txt_MatChange").getVisible()===false&&sap.ui.getCore().byId("Txt_VALIDFROMCHANGE").getVisible()===false&&sap.ui.getCore().byId("Txt_MATREVISION").getVisible()===false){if(sap.ui.getCore().byId("CreateChngMgmttitchng")!==undefined){sap.ui.getCore().byId("CreateChngMgmttitchng").destroy();sap.ui.getCore().byId("matchngmgmtchngForm").destroy();}}},getSetNotesChangedData:function(r,p,v){var i,j,a;var n=this.i18n.getText("Nodata");this.aNotesDetailData=$.extend(true,{},r);var N=r.data.__batchResponses[0].data.MATERIAL2LONGTEXTSRel;if(N.results.length>0){var I={results:[]};var b={results:[]};var d={results:[]};var q={results:[]};var P={results:[]};sap.ui.getCore().byId("matNotesChangedPanel").destroyContent();this.omatBasicTxtNotesTable="";this.omatBasicTxtNotesTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MatChangeTableReuse',this);sap.ui.getCore().byId("matNotesChangedPanel").addContent(this.omatBasicTxtNotesTable);this.omatBasicTxtNotesTable.setGrowing(true);fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setHeaderToolbar(this.omatBasicTxtNotesTable,this.i18n.getText("Mat_Basic_Txt"));this.omatIntComntNotesTable="";this.omatIntComntNotesTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MatChangeTableReuse',this);sap.ui.getCore().byId("matNotesChangedPanel").addContent(this.omatIntComntNotesTable);this.omatIntComntNotesTable.setGrowing(true);fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setHeaderToolbar(this.omatIntComntNotesTable,this.i18n.getText("Mat_Internal_Comment"));this.omatPurchONotesTable="";this.omatPurchONotesTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MatChangeTableReuse',this);sap.ui.getCore().byId("matNotesChangedPanel").addContent(this.omatPurchONotesTable);this.omatPurchONotesTable.setGrowing(true);fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setHeaderToolbar(this.omatPurchONotesTable,this.i18n.getText("Mat_Purch_Order_Txt"));this.omatQualityInsNotesTable="";this.omatQualityInsNotesTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MatChangeTableReuse',this);sap.ui.getCore().byId("matNotesChangedPanel").addContent(this.omatQualityInsNotesTable);this.omatQualityInsNotesTable.setGrowing(true);fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setHeaderToolbar(this.omatQualityInsNotesTable,this.i18n.getText("Mat_Quality_Inspection"));for(i=0;i<N.results.length;i++){if(N.results[i].ChangeData!==undefined){for(j=0;j<N.results[i].ChangeData.results.length;j++){a=N.results[i].ChangeData.results[j].Attribute;if(a==='NOTEINTCM'||a==='TXTMI'||a==='TXTPURCH'||a==='NOTEBSCDA'||a==='TXTQINSP'){N.results[i].ChangeData.results[j].ChangeKey=N.results[i].LANGUCODE__TXT+" "+"("+N.results[i].LANGUCODE+")";N.results[i].ChangeData.results[j].Entity="";if(N.results[i].ChangeData.results[j].OldValue===""&&N.results[i].ChangeData.results[j].EntityAction===fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getCreateEntityAction()){N.results[i].ChangeData.results[j].NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getAddedInstanceString();N.results[i].ChangeData.results[j].AttributeDesc="";}if(N.results[i].ChangeData.results[j].OldValue!==""&&N.results[i].ChangeData.results[j].EntityAction===fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeleteEntityAction()){N.results[i].ChangeData.results[j].NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeletedInstanceString();N.results[i].ChangeData.results[j].Attribute="";N.results[i].ChangeData.results[j].AttributeDesc="";}if(N.results[i].ChangeData.results[j].OldValue===""&&N.results[i].ChangeData.results[j].EntityAction===fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getUpdateEntityAction()){N.results[i].ChangeData.results[j].OldValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getNotMaintString();N.results[i].ChangeData.results[j].Attribute="";}if(N.results[i].ChangeData.results[j].OldValue!==""){N.results[i].ChangeData.results[j].OldValue=fcg.mdg.approvecrv2.util.Formatter.Truncate(N.results[i].ChangeData.results[j].OldValue);}if(N.results[i].ChangeData.results[j].NewValue!==""){N.results[i].ChangeData.results[j].NewValue=fcg.mdg.approvecrv2.util.Formatter.Truncate(N.results[i].ChangeData.results[j].NewValue);}var c=N.results[i].MATERIAL+"/"+N.results[i].LANGUCODE+"/"+"GRUN";var e=N.results[i].MATERIAL+"/"+N.results[i].LANGUCODE+"/"+"BEST";var f=N.results[i].MATERIAL+"/"+N.results[i].LANGUCODE+"/"+"IVER";var g=N.results[i].MATERIAL+"/"+N.results[i].LANGUCODE+"/"+"DSCR";var h=N.results[i].MATERIAL+"/"+N.results[i].LANGUCODE+"/"+"PRUE";N.results[i].ChangeData.results[j].Context=N.results[i].ChangeData.results[j].Context.replace(/\s+/g,'');if(N.results[i].ChangeData.results[j].Context===f){I.results.push(N.results[i].ChangeData.results[j]);}if(N.results[i].ChangeData.results[j].Context===c){b.results.push(N.results[i].ChangeData.results[j]);}if(N.results[i].ChangeData.results[j].Context===e){P.results.push(N.results[i].ChangeData.results[j]);}if(N.results[i].ChangeData.results[j].Context===g){d.results.push(N.results[i].ChangeData.results[j]);}if(N.results[i].ChangeData.results[j].Context===h){q.results.push(N.results[i].ChangeData.results[j]);}}}}}if(I.results.length>0){var o=new sap.ui.model.json.JSONModel();o.setData(I);var k=this.createTableTemplate();k.attachPress({name:'matNotesChangedDetail',TableKey:"IntComnt",Entity:I},v.navtoSubDetail,v);this.omatIntComntNotesTable.setModel(o);this.omatIntComntNotesTable.bindItems('/results',k,'','');this.aIntDetComntNotesData=I;}else{this.omatIntComntNotesTable.setVisible(false);}if(P.results.length>0){var l=new sap.ui.model.json.JSONModel();l.setData(P);var m=this.createTableTemplate();m.attachPress({name:'matNotesChangedDetail',TableKey:"PurchOrder",Entity:P},v.navtoSubDetail,v);this.omatPurchONotesTable.setModel(l);this.omatPurchONotesTable.bindItems('/results',m,'','');}else{this.omatPurchONotesTable.setVisible(false);}if(b.results.length>0){var B=new sap.ui.model.json.JSONModel();B.setData(b);var s=this.createTableTemplate();s.attachPress({name:'matNotesChangedDetail',TableKey:"BasicTxt",Entity:b},v.navtoSubDetail,v);this.omatBasicTxtNotesTable.setModel(B);this.omatBasicTxtNotesTable.bindItems('/results',s,'','');this.aBasicTxtDetNotesData=b;}else{this.omatBasicTxtNotesTable.setVisible(false);}if(d.results.length>0){this.omatDescNotesTable="";this.omatDescNotesTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MatChangeTableReuse',this);sap.ui.getCore().byId("matNotesChangedPanel").addContent(this.omatDescNotesTable);this.omatDescNotesTable.setGrowing(true);fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setHeaderToolbar(this.omatDescNotesTable,this.i18n.getText("Mat_Txt_Description"));var D=new sap.ui.model.json.JSONModel();D.setData(d);var t=this.createTableTemplate();t.attachPress({name:'matNotesChangedDetail',TableKey:'Desc',Entity:d},v.navtoSubDetail,v);this.omatDescNotesTable.setModel(D);this.omatDescNotesTable.bindItems('/results',t,'','');this.aDescDetNotesData=d;}if(q.results.length>0){var Q=new sap.ui.model.json.JSONModel();Q.setData(q);var u=this.createTableTemplate();u.attachPress({name:'matNotesChangedDetail',TableKey:'QualityIns',Entity:q},v.navtoSubDetail,v);this.omatQualityInsNotesTable.setModel(Q);this.omatQualityInsNotesTable.bindItems('/results',u,'','');this.aQualityInsDetNotesData=q;}else{this.omatQualityInsNotesTable.setVisible(false);}if(I.results.length===0&&b.results.length==0&&d.results.length===0&&q.results.length===0&&P.results.length===0){var w=sap.ui.getCore().byId("matNotesChangedPanel");fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialCreate.setNoDataText(w,n);}}},getSetClassificationChangedData:function(r,p,v){var n=this.i18n.getText("Nodata");var i,j,a;this.aClassificationDetailData=$.extend(true,{},r);var c=this.i18n.getText("Mat_Class_Type")+","+" "+this.i18n.getText("Mat_Change_No");var C={results:[]};var b={results:[]};var d={EntityDesc:"",Entity:"",AttributeDesc:"",Context:"",NewValue:"",OldValue:"",NewValueText:"",OldValueText:"",VALID_FROM:"",CLASSTYPE:"",CLASSTYPE__TXT:"",Change_Number:"",ChangeKey:""};if(r.data.MATERIAL2CLASSTYPERel.results.length>0){for(j=0;j<r.data.MATERIAL2CLASSTYPERel.results.length;j++){for(i=0;i<r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results.length;i++){a=r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].Attribute;if(a==='CLASS'){r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].OldValue="";if(r.data.MATERIAL2CLASSTYPERel.results[j].CHANGENO!==""&&r.data.MATERIAL2CLASSTYPERel.results[j].VALID_FROM!==""){r.data.MATERIAL2CLASSTYPERel.results[j].VALID_FROM=fcg.mdg.approvecrv2.util.Formatter.matDateFormat(r.data.MATERIAL2CLASSTYPERel.results[j].VALID_FROM);d.VALID_FROM=r.data.MATERIAL2CLASSTYPERel.results[j].VALID_FROM;this.vVaidFromflag=1;d.ChangeKey=r.data.MATERIAL2CLASSTYPERel.results[j].CLASSTYPE__TXT+" "+"("+r.data.MATERIAL2CLASSTYPERel.results[j].CLASSTYPE+")"+","+" "+r.data.MATERIAL2CLASSTYPERel.results[j].CHANGENO+" "+"("+d.VALID_FROM+")";d.Entity=c;d.EntityDesc=r.data.MATERIAL2CLASSTYPERel.results[j].CHANGENO;d.AttributeDesc=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].NewValue,r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].NewValueText);}else{d.ChangeKey=r.data.MATERIAL2CLASSTYPERel.results[j].CLASSTYPE__TXT+" "+"("+r.data.MATERIAL2CLASSTYPERel.results[j].CLASSTYPE+")";d.Entity=this.i18n.getText("Mat_Class_Type");d.EntityDesc=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getNotMaintString();d.VALID_FROM=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getNotMaintString();d.AttributeDesc=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].NewValue,r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].NewValueText);}if(r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].EntityAction===fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getCreateEntityAction()){d.NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getAddedInstanceString();}if(r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].EntityAction===fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeleteEntityAction()){d.NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeletedInstanceString();}d.Context=r.data.MATERIAL2CLASSTYPERel.results[j].CLASSTYPE;d.CLASSTYPE__TXT=r.data.MATERIAL2CLASSTYPERel.results[j].CLASSTYPE__TXT;var D=$.extend(true,{},d);C.results.push(D);}else{if(r.data.MATERIAL2CLASSTYPERel.results[j].CHANGENO!==""&&r.data.MATERIAL2CLASSTYPERel.results[j].VALID_FROM!==""){d.AttributeDesc=r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].AttributeDesc;if(this.vVaidFromflag===0){r.data.MATERIAL2CLASSTYPERel.results[j].VALID_FROM=fcg.mdg.approvecrv2.util.Formatter.matDateFormat(r.data.MATERIAL2CLASSTYPERel.results[j].VALID_FROM);}d.VALID_FROM=r.data.MATERIAL2CLASSTYPERel.results[j].VALID_FROM;d.ChangeKey=r.data.MATERIAL2CLASSTYPERel.results[j].CLASSTYPE__TXT+" "+"("+r.data.MATERIAL2CLASSTYPERel.results[j].CLASSTYPE+")"+","+" "+r.data.MATERIAL2CLASSTYPERel.results[j].CHANGENO+" "+"("+r.data.MATERIAL2CLASSTYPERel.results[j].VALID_FROM+")";d.Entity=this.i18n.getText("Mat_Class_Type")+","+" "+this.i18n.getText("Mat_Change_No");d.EntityDesc=r.data.MATERIAL2CLASSTYPERel.results[j].CHANGENO;d.NewValue=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].NewValue,r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].NewValueText);d.OldValue=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].OldValue,r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].OldValueText);}else{d.AttributeDesc=r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].AttributeDesc;d.ChangeKey=r.data.MATERIAL2CLASSTYPERel.results[j].CLASSTYPE__TXT+" "+"("+r.data.MATERIAL2CLASSTYPERel.results[j].CLASSTYPE+")";d.Entity=this.i18n.getText("Mat_Class_Type");d.EntityDesc=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getNotMaintString();d.VALID_FROM=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getNotMaintString();}if(r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].NewValue===""){d.NewValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeletedAttributeString();}else{d.NewValue=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].NewValue,r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].NewValueText);}if(r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].OldValue===""){d.OldValue=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getNotMaintString();}else{d.OldValue=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].OldValue,r.data.MATERIAL2CLASSTYPERel.results[j].ChangeData.results[i].OldValueText);}d.Context=r.data.MATERIAL2CLASSTYPERel.results[j].CLASSTYPE;d.CLASSTYPE__TXT=r.data.MATERIAL2CLASSTYPERel.results[j].CLASSTYPE__TXT;var o=$.extend(true,{},d);b.results.push(o);}}}}sap.ui.getCore().byId("matClassificationChangedPanel").removeAllContent();if(C.results.length>0){var I=this.createClassTableTemplate();this.omatClassTable="";this.omatClassTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MatClassifictionChangeTable',this);sap.ui.getCore().byId("matClassificationChangedPanel").addContent(this.omatClassTable);this.omatClassTable.setGrowing(true);fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setHeaderToolbar(this.omatClassTable,this.i18n.getText("Mat_Class"));I.attachPress({Entity:C,name:'matClassChangedDetail'},v.navtoSubDetail,v);var e=new sap.ui.model.json.JSONModel();e.setData(C);this.omatClassTable.setModel(e);this.omatClassTable.bindItems('/results',I,'','');}if(b.results.length>0){var f=this.createTableTemplate();this.omatCharTable="";this.omatCharTable=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MatChangeTableReuse',this);sap.ui.getCore().byId("matClassificationChangedPanel").addContent(this.omatCharTable);this.omatCharTable.setGrowing(true);fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setHeaderToolbar(this.omatCharTable,this.i18n.getText("Mat_Class_Characteristic"));f.attachPress({Entity:b,name:'matCharChangedDetail'},v.navtoSubDetail,v);var g=new sap.ui.model.json.JSONModel();g.setData(b);this.omatCharTable.setModel(g);this.omatCharTable.bindItems('/results',f,'','');}if(b.results.length===0&&C.results.length===0){var P=sap.ui.getCore().byId("matClassificationChangedPanel");fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialCreate.setNoDataText(P,n);}},FormatDateNewVal:function(n){if(n==="00.00.0000"||n==="00,00,0000"){return fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeletedAttributeString();}else{return n;}},FormatDateOldVal:function(o){if(o==="00.00.0000"||o==="00,00,0000"){return"";}else{return o;}},getUomChangedData:function(){return this.vUomChngData;},getChangedWeightData:function(w,e,a,u,c,U){var A=w.Attribute;var n=w.NewValue;var o=w.OldValue;var N=w.NewValueText;var O=w.OldValueText;w.OldValue=this.getoldValueZeroes(o);w.NewValue=this.getnewValueZeroes(n);if(o!==""&&O!==""&&w.OldValue!=="("+this.i18n.getText("PC_NOT_MAIN")+")"){w.OldValue=w.OldValue+" "+w.OldValueText;w.OldValueText="";}if(n!==""&&N!==""&&w.NewValue!==fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDeletedAttributeString()){w.NewValue=w.NewValue+" "+w.NewValueText;w.NewValueText="";}if(e===""){w.ChangeKey=a;w.Entity=u;}else{w.ChangeKey=a+","+" "+e;w.Entity=c;}w.UnitOfMeasure=U;var d=$.extend(true,{},w);return d;}};
