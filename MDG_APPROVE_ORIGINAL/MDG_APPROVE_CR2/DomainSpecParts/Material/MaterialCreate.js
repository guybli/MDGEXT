/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.declare("fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialCreate");jQuery.sap.require("fcg.mdg.approvecrv2.util.DataAccess");jQuery.sap.require("fcg.mdg.approvecrv2.DomainSpecParts.Material.Material");fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialCreate={oMaterialCreateForm:"",oMaterialPlantTable:"",oMaterialPlantForm:"",flag:0,oSalesTableForm:"",aSales:"",aSalesDetailData:"",i18n:sap.ca.scfld.md.app.Application.getImpl().getResourceBundle(),oSalesTableS4Details:"",oS3View:"",aSalesdata:"",SalesOrgHeaderTxt:"",aSalesTaxTextData:"",vNoDataTxt:"",oS3Controller:"",oMatBasChangeController:"",load_General_Data:function(s){this.oMatBasChangeController=fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialBasicDataChange.getInstance();this.oMatBasChangeController.aClassificationDetailData="";this.oS3Controller=s;this.vNoDataTxt=this.i18n.getText("NodataCreate");try{sap.ui.getCore().byId("matCreateLayout").destroy();}catch(e){}if(this.oMaterialCreateForm===""){this.oMaterialCreateForm=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MaterialBasicDataCreate',fcg.mdg.approvecrv2.util.Formatter);}else{this.oMaterialCreateForm.destroy();this.oMaterialCreateForm=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MaterialBasicDataCreate',fcg.mdg.approvecrv2.util.Formatter);}sap.ui.getCore().byId("materialDataLayout").removeAllContent();sap.ui.getCore().byId("materialchgmngLayout").removeAllContent();sap.ui.getCore().byId("materialDataLayout").addContent(this.oMaterialCreateForm);if(sap.ui.getCore().byId("materialPanelDataLayout")!==undefined){sap.ui.getCore().byId("materialPanelDataLayout").destroy();}if(sap.ui.getCore().byId("materialChangedDataLayout")!==undefined){sap.ui.getCore().byId("materialChangedDataLayout").destroy();}if(sap.ui.getCore().byId("materialchgmngLayout")!==undefined){sap.ui.getCore().byId("materialchgmngLayout").destroy();}var p=fcg.mdg.approvecrv2.util.Formatter.getMatVisibiltyBasedOnParameter('E');if(p===false){if(sap.ui.getCore().byId("matPurchasingPanel")!==undefined){sap.ui.getCore().byId("matPurchasingPanel").destroy();}}var c=fcg.mdg.approvecrv2.util.Formatter.getMatVisibiltyBasedOnParameter('C');if(c===false){if(sap.ui.getCore().byId("matClassificationPanel")!==undefined){sap.ui.getCore().byId("matClassificationPanel").destroy();}}},displayGeneralData:function(r,v){if(r.data.MATERIAL2MATCHGMNGRel.results.length>0){var c=new sap.ui.model.json.JSONModel();c.setData(r.data.MATERIAL2MATCHGMNGRel.results[0]);sap.ui.getCore().byId("Txt_ECOCHGMNG").setModel(c);sap.ui.getCore().byId("Txt_VALID_FROM").setModel(c);sap.ui.getCore().byId("Txt_REVCHGMNG").setModel(c);sap.ui.getCore().byId("CreateMatATPCoreTitle").destroy();sap.ui.getCore().byId("idGroupingCoreTitle").destroy();sap.ui.getCore().byId("idmatDesign_DataCoreTitle").destroy();sap.ui.getCore().byId("idMat_ConfigurationCoreTitle").destroy();sap.ui.getCore().byId("idMat_EnvironmentCoreTitle").destroy();}else{sap.ui.getCore().byId("CreateMatATPTitle").destroy();sap.ui.getCore().byId("idGrouping").destroy();sap.ui.getCore().byId("idmatDesign_Data").destroy();sap.ui.getCore().byId("idMat_Configuration").destroy();sap.ui.getCore().byId("idMat_Environment").destroy();}var d=new sap.ui.model.json.JSONModel();if(r.data.SERLV===""){r.data.SERLV=r.data.SERLV__TXT;r.data.SERLV__TXT="";}d.setData(r.data);sap.ui.getCore().byId("matBasicDataForm").setModel(d);this.hideSection(this.oS3Controller);sap.ui.getCore().byId("matGtinPanel").attachExpand("",v.onPanelExpand,v);if(sap.ui.getCore().byId("matPurchasingPanel")!==undefined){sap.ui.getCore().byId("matPurchasingPanel").attachExpand("",v.onPanelExpand,v);}sap.ui.getCore().byId("matNotesPanel").attachExpand("",v.onPanelExpand,v);if(sap.ui.getCore().byId("matClassificationPanel")!==undefined){sap.ui.getCore().byId("matClassificationPanel").attachExpand("",v.onPanelExpand,v);}this.oS3Controller.matHookModifyPanelExpand(v);},bindPanelData:function(r,p,v){if(p==='matGtinPanel'){var o={dataitems:[]};if(r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results.length>0||r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results.length>0){o=this.getGtinData(r);this.getGtiinModel(o,v);var d=sap.ui.getCore().byId("matDimensionTable");var D=sap.ui.getCore().byId("DimensionpersIcon");var I="/dataitems";fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setTablePersonalization(I,d,D);}else{var a=sap.ui.getCore().byId("matGtinPanel");this.setNoDataText(a,this.vNoDataTxt);}}if(p==='matClassificationPanel'){var b=sap.ui.getCore().byId("Combo_Class_Type");var c=sap.ui.getCore().byId("matClfChangeno");var e;var n="";if(r!==null&&r.data.MATERIAL2CLASSTYPERel.results.length>0&&r!==undefined){e=[];var f=[];o={dataitems:[]};var g=[];var h=[];for(var i=0;i<r.data.MATERIAL2CLASSTYPERel.results.length;i++){h={"changeno":r.data.MATERIAL2CLASSTYPERel.results[i].CHANGENO,"validfrom":r.data.MATERIAL2CLASSTYPERel.results[i].VALID_FROM};if(g.length!==0){var F=false;for(var j=0;j<g.length;j++){if(g[j].changeno===h.changeno){F=true;break;}}if(F===false){g.push(h);}}else{g.push(h);}f={"classtype":r.data.MATERIAL2CLASSTYPERel.results[i].CLASSTYPE,"classtype_txt":r.data.MATERIAL2CLASSTYPERel.results[i].CLASSTYPE+" - "+r.data.MATERIAL2CLASSTYPERel.results[i].CLASSTYPE__TXT};if(e.length!==0){var F=false;for(var j=0;j<e.length;j++){if(e[j].classtype===f.classtype){F=true;break;}}if(F===false){e.push(f);}}else{e.push(f);}if(r.data.MATERIAL2CLASSTYPERel.results[i].DEFAULT_CLASSTYPE===true){var s=r.data.MATERIAL2CLASSTYPERel.results[i].CLASSTYPE;b.setSelectedKey(s);var S=r.data.MATERIAL2CLASSTYPERel.results[i].CHANGENO;c.setSelectedKey(S);sap.ui.getCore().byId("matCCValidity").setValue(fcg.mdg.approvecrv2.util.Formatter.matDateFormat(r.data.MATERIAL2CLASSTYPERel.results[i].VALID_FROM));var t=sap.ui.getCore().byId("idCharacteristicTable");var T=sap.ui.getCore().byId("idClasificationTable");this.getDataOnSelection(s,S,T,t,r.data.MATERIAL2CLASSTYPERel.results[i]);}}var O={results:e};var k={results:g};if(k.results.length!==0){var l=k.results;if(k.results.length===1&&l[0].changeno===""){c.setVisible(false);sap.ui.getCore().byId("matCCValidity").setVisible(false);}else{c.bindProperty("editable","false");var m=new sap.ui.model.json.JSONModel();m.setData(k);c.setModel(m);var q=new sap.ui.core.ListItem();q.bindProperty("text","changeno");q.bindProperty("key","changeno");c.bindItems('/results',q,'','');c.attachSelectionChange({Entity:r},this.onChangeNoselection,this);}}else{c.setVisible(false);sap.ui.getCore().byId("matCCValidity").setVisible(false);}b.bindProperty("editable","false");var u=new sap.ui.model.json.JSONModel();u.setData(O);b.setModel(u);var w=new sap.ui.core.ListItem();w.bindProperty("text","classtype_txt");w.bindProperty("key","classtype");b.bindItems('/results',w,'','');sap.ui.getCore().byId("Combo_Class_Type").attachSelectionChange({Entity:r},this.OnFilterCombo,this);}else{var P=sap.ui.getCore().byId("matClassificationPanel");this.setNoDataText(P,this.vNoDataTxt);}}if(p==='matPurchasingPanel'){var x=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getGeneralDetailData();if(r[0].data!==null||r.data!==undefined){if(r[0].data.VABME===""&&r[0].data.VABME__TXT!==""){r[0].data.VABME=r[0].data.VABME__TXT;r[0].data.VABME__TXT="";}if(x.data.NRFHG===""&&x.data.NRFHG__TXT!==""){x.data.NRFHG=x.data.NRFHG__TXT;x.data.NRFHG__TXT="";}var R=r[0].data;u=new sap.ui.model.json.JSONModel();u.setData(R);sap.ui.getCore().byId("matpurchasingform").setModel(u);var y=new sap.ui.model.json.JSONModel();y.setData(r[1].data);var z=new sap.ui.model.json.JSONModel();z.setData(x.data);sap.ui.getCore().byId("Txt_NRFHG").setModel(z);sap.ui.getCore().byId("Txt_QMPUR").setModel(y);sap.ui.getCore().byId("Txt_RBNRM").setModel(y);this.hideGeneralPurchSection(this.oS3Controller);}else{var A=sap.ui.getCore().byId("matPurchasingPanel");this.setNoDataText(A,this.vNoDataTxt);}}if(p==='matNotesPanel'){this.GetNotesData(r,v);}this.oS3Controller.matHookModifyBindPanelData(r,p,v);},getGeneralDataQuery:function(m){var q;q="/MATERIALCollection"+"('"+m+"')";return q;},OnFilterCombo:function(e,d){var c=e.getSource().getSelectedKey();var C=sap.ui.getCore().byId("matClfChangeno").getSelectedKey();var t=sap.ui.getCore().byId("idCharacteristicTable");var T=sap.ui.getCore().byId("idClasificationTable");this.getDataOnSelection(c,C,T,t);},onChangeNoselection:function(e,d){var s=e.getSource().getSelectedItem();var p=s.getBindingContext().getPath().slice(9.10);var v=d.Entity.data.MATERIAL2CLASSTYPERel.results[p].VALID_FROM;sap.ui.getCore().byId("matCCValidity").setValue(fcg.mdg.approvecrv2.util.Formatter.matDateFormat(v));var t=sap.ui.getCore().byId("idCharacteristicTable");var T=sap.ui.getCore().byId("idClasificationTable");var c=e.getSource().getSelectedKey();var C=sap.ui.getCore().byId("Combo_Class_Type").getSelectedKey();this.getDataOnSelection(C,c,T,t);},getDataOnSelection:function(c,a,b,d,e){var D;var o;var f={dataitems:[]};var g={dataitems:[]};var h;this.oS3Controller=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getS3Instance();if(e===undefined){h=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getMatClassData(c,a);}else{h=e;}for(var i=0;i<h.CLASSTYPE2CLASSASGNRel.results.length;i++){var k=h.CLASSTYPE2CLASSASGNRel.results[i].CLASS;var l=h.CLASSTYPE2CLASSASGNRel.results[i].CLINT__TXT;var m=h.CLASSTYPE2CLASSASGNRel.results[i].STATUS__TXT;var n=h.CLASSTYPE2CLASSASGNRel.results[i].CLSTATUS;var p=h.CLASSTYPE2CLASSASGNRel.results[i].CLASS__TXT;o={"classdata":k,"classtatus":n,"classtatxt":m,"class__txt":l,"classlongtxt":p};g.dataitems.push(o);}for(var j=0;j<h.CLASSTYPE2VALUATIONRel.results.length;j++){var q=h.CLASSTYPE2VALUATIONRel.results[j].CHARID;var r=h.CLASSTYPE2VALUATIONRel.results[j].ATWRT;var v=h.CLASSTYPE2VALUATIONRel.results[j].ATAWE__TXT;if(r!==""){D={"characteristic":q,"charvaluetext":v,"charvalue":r};f.dataitems.push(D);}}var s=fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialBasicDataChange.getClassificationChangeData();var C;if(s!==""){C=new sap.ui.model.json.JSONModel();C.setData(s);}if(f.dataitems.length>0){var t=new sap.ui.model.json.JSONModel();t.setData(f);var I=this.GetCharTableTemplate(t,C,this.oS3Controller);d.setModel(t);d.bindItems('/dataitems',I,'','');d.setVisible(true);}else{d.setVisible(false);}if(g.dataitems.length>0){var u=new sap.ui.model.json.JSONModel();u.setData(g);var w=this.GetClassTableTemplate(u,C,this.oS3Controller);b.setModel(u);b.bindItems('/dataitems',w,'','');b.setVisible(true);}else{b.setVisible(false);}if(b.getVisible()===false&&d.getVisible()===false){if(sap.ui.getCore().byId("matClassificationChangeLayout")!==undefined){var L=sap.ui.getCore().byId("matClassificationChangeLayout");var N=this.i18n.getText("Mat_No_Class");fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialCreate.setNoDataText(L,N);}}},GetClassTableTemplate:function(c,C,s){var i=new sap.m.ColumnListItem({cells:[new sap.m.Text({text:{path:'classdata',formatter:function(){var d=c.getProperty("class__txt",this.getBindingContext());var k=c.getProperty("classdata",this.getBindingContext());if(k===""&&d===""){return fcg.mdg.approvecrv2.util.Formatter.noValue(k);}else{if(C!==""||C!==undefined){fcg.mdg.approvecrv2.util.Formatter.handleCellMatclassBolding(this,c,"CLASS",C);}return fcg.mdg.approvecrv2.util.Formatter.noValue(fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,d));}}}}),new sap.m.Text({text:{path:"classtatus",formatter:function(){var d=c.getProperty("classtatxt",this.getBindingContext());var k=c.getProperty("classtatus",this.getBindingContext());if(k===""&&d===""){return fcg.mdg.approvecrv2.util.Formatter.noValue(k);}else{if(C!==""||C!==undefined){fcg.mdg.approvecrv2.util.Formatter.handleCellMatclassBolding(this,c,"CLASS",C);}return fcg.mdg.approvecrv2.util.Formatter.noValue(fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,d));}}}}),new sap.m.Text({text:{path:"classlongtxt",formatter:function(){if(C!==""||C!==undefined){fcg.mdg.approvecrv2.util.Formatter.handleCellMatclassBolding(this,c,"CLASS",C);}return fcg.mdg.approvecrv2.util.Formatter.noValue(c.getProperty('classlongtxt',this.getBindingContext()));}}})]});var e=s.matHookGetClassificationTableTemplate(i);if(e!==undefined){i=e;}return i;},GetCharTableTemplate:function(c,C,s){var i=new sap.m.ColumnListItem({cells:[new sap.m.Text({text:{path:"characteristic",formatter:function(){if(C!==""||C!==undefined){fcg.mdg.approvecrv2.util.Formatter.handleCellMatcharBolding(this,c,"VALUATION",C);}return fcg.mdg.approvecrv2.util.Formatter.noValue(c.getProperty('characteristic',this.getBindingContext()));}}}),new sap.m.Text({text:{path:"charvalue",formatter:function(){if(C!==""||C!==undefined){fcg.mdg.approvecrv2.util.Formatter.handleCellMatcharBolding(this,c,"VALUATION",C);}var k=c.getProperty("charvalue",this.getBindingContext());var d=c.getProperty("charvaluetext",this.getBindingContext());return fcg.mdg.approvecrv2.util.Formatter.noValue(fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,d));}}})]});var e=s.matHookGetCharTableTemplate(i);if(e!==undefined){i=e;}return i;},setNoDataText:function(p,n){var l=new sap.m.VBox({items:[new sap.m.Text(),new sap.m.Text({text:n}),new sap.m.Text()]});l.setAlignItems("Center");l.setJustifyContent("Center");p.destroyContent();p.addContent(l);},GetNotesTableTemplate:function(g){var i=new sap.m.ColumnListItem({type:"Navigation",cells:[new sap.m.Text({text:"{LANGUCODE__TXT} ({LANGUCODE})"}),new sap.m.Text({text:{path:"LONGTEXT",formatter:function(){var d=g.getProperty("LONGTEXT",this.getBindingContext());return fcg.mdg.approvecrv2.util.Formatter.Truncate(d);}}})]});var e=this.oS3Controller.matHookgetNotesTableTemplate(i);if(e!==undefined){i=e;}return i;},GetGTINTableTemplate:function(g){var i=new sap.m.ColumnListItem({type:"Navigation",cells:[new sap.m.Text({text:{path:"quantity"}}),new sap.m.Text({text:{path:'unitofmeasure',formatter:function(){var d=g.getProperty("unitofmeasure_txt",this.getBindingContext());var k=g.getProperty("unitofmeasure",this.getBindingContext());if(k===""&&d===""){return fcg.mdg.approvecrv2.util.Formatter.noValue(k);}else{return fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,d);}}}}),new sap.m.Text({text:{path:"basequantity"}}),new sap.m.Text({text:{path:'baseunitofmeasure',formatter:function(){var d=g.getProperty("baseunitofmeasure_txt",this.getBindingContext());var k=g.getProperty("baseunitofmeasure",this.getBindingContext());if(k===""&&d===""){return fcg.mdg.approvecrv2.util.Formatter.noValue(k);}else{return fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,d);}}}}),new sap.m.Text({text:{path:"eanupc"}}),new sap.m.Text({text:{path:"hpean",formatter:fcg.mdg.approvecrv2.util.Formatter.checkBoxTable}})]});var e=this.oS3Controller.matHookgetGtinTableTemplate(i,g);if(e!==undefined){i=e;}return i;},hideSection:function(s){if(sap.ui.getCore().byId("Txt_ECOCHGMNG").getVisible()===false&&sap.ui.getCore().byId("Txt_VALID_FROM").getVisible()===false&&sap.ui.getCore().byId("Txt_REVCHGMNG").getVisible()===false){if(sap.ui.getCore().byId("CreateChngMgmttit")!==undefined){sap.ui.getCore().byId("CreateChngMgmttit").destroy();sap.ui.getCore().byId("Mat_Basic_Data_title").destroy();}}var a=s.matHideATPSection();if(a===false){if(sap.ui.getCore().byId("Txt_KOSCH").getVisible()===false){if(sap.ui.getCore().byId("CreateMatATPTitle")!==undefined){sap.ui.getCore().byId("CreateMatATPTitle").destroy();}if(sap.ui.getCore().byId("CreateMatATPCoreTitle")!==undefined){sap.ui.getCore().byId("CreateMatATPCoreTitle").destroy();}}}var g=s.matHideGroupingSection();if(g===false){if(sap.ui.getCore().byId("Txt_EXTWG").getVisible()===false&&sap.ui.getCore().byId("Txt_PRDHA").getVisible()===false&&sap.ui.getCore().byId("Txt_MTPOSMARA").getVisible()===false&&sap.ui.getCore().byId("Txt_MAGRVMARA").getVisible()===false){if(sap.ui.getCore().byId("idGrouping")!==undefined){sap.ui.getCore().byId("idGrouping").destroy();}if(sap.ui.getCore().byId("idGroupingCoreTitle")!==undefined){sap.ui.getCore().byId("idGroupingCoreTitle").destroy();}}}var d=s.matHideDesignDataSection();if(d===false){if(sap.ui.getCore().byId("Txt_LABOR").getText()===""&&sap.ui.getCore().byId("Txt_NORMT").getText()===""&&sap.ui.getCore().byId("Txt_WRKST").getText()===""&&sap.ui.getCore().byId("Txt_FERTH").getText()===""&&sap.ui.getCore().byId("Txt_FORMT").getText()===""&&sap.ui.getCore().byId("Txt_CADKZ").getVisible()===false){if(sap.ui.getCore().byId("idmatDesign_Data")!==undefined){sap.ui.getCore().byId("idmatDesign_Data").destroy();}if(sap.ui.getCore().byId("idmatDesign_DataCoreTitle")!==undefined){sap.ui.getCore().byId("idmatDesign_DataCoreTitle").destroy();}}}var c=s.matHideConfigurationSection();if(c===false){if(sap.ui.getCore().byId("Txt_SATNR").getVisible()===false&&sap.ui.getCore().byId("Txt_KZKFG").getVisible()===false){if(sap.ui.getCore().byId("idMat_Configuration")!==undefined){sap.ui.getCore().byId("idMat_Configuration").destroy();}if(sap.ui.getCore().byId("idMat_ConfigurationCoreTitle")!==undefined){sap.ui.getCore().byId("idMat_ConfigurationCoreTitle").destroy();}}}var e=s.matHideEnvironmentSection();if(e===false){if(sap.ui.getCore().byId("Txt_KZUMW").getVisible()===false&&sap.ui.getCore().byId("Txt_PROFL").getVisible()===false){if(sap.ui.getCore().byId("idMat_EnvironmentCoreTitle")!==undefined){sap.ui.getCore().byId("idMat_EnvironmentCoreTitle").destroy();}if(sap.ui.getCore().byId("idMat_Environment")!==undefined){sap.ui.getCore().byId("idMat_Environment").destroy();}}}},hideGeneralPurchSection:function(s){var p=s.matHideProcurementSection();if(p===false){if(sap.ui.getCore().byId("Txt_MFRPN").getVisible()===false&&sap.ui.getCore().byId("Txt_MPROF").getVisible()===false&&sap.ui.getCore().byId("Txt_MFRNR").getVisible()===false){if(sap.ui.getCore().byId("idPur_Procurement")!==undefined){sap.ui.getCore().byId("idPur_Procurement").destroy();}}}var q=s.matHideQualitySection();if(q===false){if(sap.ui.getCore().byId("Txt_QMPUR").getVisible()===false&&sap.ui.getCore().byId("Txt_RBNRM").getVisible()===false){if(sap.ui.getCore().byId("idPur_Quality_Management")!==undefined){sap.ui.getCore().byId("idPur_Quality_Management").destroy();}}}if(sap.ui.getCore().byId("Txt_BSTME").getVisible()===false&&sap.ui.getCore().byId("Txt_NRFHG").getVisible()===false&&sap.ui.getCore().byId("Txt_BSTME").getVisible()===false&&sap.ui.getCore().byId("Txt_EKWSL").getVisible()===false&&sap.ui.getCore().byId("Txt_MAHN1").getVisible()===false&&sap.ui.getCore().byId("Txt_MAHN2").getVisible()===false&&sap.ui.getCore().byId("Txt_MAHN3").getVisible()===false&&sap.ui.getCore().byId("Txt_WELFZ").getVisible()===false&&sap.ui.getCore().byId("Txt_UNTTO").getVisible()===false&&sap.ui.getCore().byId("Txt_UEBTO").getVisible()===false&&sap.ui.getCore().byId("Txt_WEPRZ").getVisible()===false&&sap.ui.getCore().byId("Txt_UEBTK").getVisible()===false&&sap.ui.getCore().byId("Txt_KZABS").getVisible()===false&&sap.ui.getCore().byId("Txt_MPROF").getVisible()===false&&sap.ui.getCore().byId("Txt_MFRNR").getVisible()===false&&sap.ui.getCore().byId("Txt_MFRPN").getVisible()===false&&sap.ui.getCore().byId("Txt_RBNRM").getVisible()===false&&sap.ui.getCore().byId("Txt_QMPUR").getVisible()===false){var a=sap.ui.getCore().byId("matPurchasingPanel");this.setNoDataText(a,this.vNoDataTxt);}},getGtinData:function(r){var o={dataitems:[]};var i,j,v,e,d,q,u,b,a,c,h,f,g,k,l,m,B,n,s;var p=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getGeneralDetailData();if(p.data.MEINS!==""){B=p.data.MEINS;n=p.data.MEINS__TXT;}else{B="";n="";}for(i=0;i<r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results.length;i++){this.flag=0;v=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].QTEUNIT;e=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].EAN_MARM;for(j=0;j<r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results.length;j++){if(v===r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results[j].QTEUNIT&&e===r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results[j].EAN){q=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].UMREN;u=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].QTEUNIT;f=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].QTEUNIT__TXT;b=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].UMREZ;a=B;g=n;c=r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results[j].EAN;h=r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results[j].HPEAN;k=r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results[j].EANTP_MEA;l=r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results[j].EANTP_MEA__TXT;m=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].GTIN_VAR2;s="ab"+u;d=this.getGtinoDataItems(q,u,f,b,a,g,c,h,k,l,m,s);o.dataitems.push(d);this.flag=1;}}if(this.flag===0){q=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].UMREN;u=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].QTEUNIT;f=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].QTEUNIT__TXT;b=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].UMREZ;a=B;g=n;c=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].EAN_MARM;k=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].NUMTP2;l=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].NUMTP2__TXT;m=r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[i].GTIN_VAR2;h="";s="ab"+u;if(c===undefined||c===null){c="";}d=this.getGtinoDataItems(q,u,f,b,a,g,c,h,k,l,m,s);o.dataitems.push(d);}}for(i=0;i<r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results.length;i++){this.vGtinflag=0;v=r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results[i].QTEUNIT;e=r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results[i].EAN;for(var j=0;j<r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results.length;j++){if(v===r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[j].QTEUNIT&&e===r.data.__batchResponses[0].data.MATERIAL2UNITOFMSRRel.results[j].EAN_MARM){this.vGtinflag=1;}}if(this.vGtinflag===0){q="";u=r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results[i].QTEUNIT;f=r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results[i].QTEUNIT__TXT;b="";a=B;g=n;c=r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results[i].EAN;h=r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results[i].HPEAN;k=r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results[i].EANTP_MEA;l=r.data.__batchResponses[0].data.MATERIAL2MEAN_GTINRel.results[i].EANTP_MEA__TXT;m="";s="ab"+u;if(c===undefined||c===null){c="";}d=this.getGtinoDataItems(q,u,f,b,a,g,c,h,k,l,m,s);o.dataitems.push(d);}}for(i=0;i<o.dataitems.length;i++){if(o.dataitems[i].unitofmeasure===a){o.dataitems[i].sorter="aa"+o.dataitems[i].unitofmeasure;}}this.oGtinDetailData=o;return o;},getGtinDetailData:function(){return this.oGtinDetailData;},getGtiinModel:function(o,v){var t=sap.ui.getCore().byId("matDimensionTable");var g=new sap.ui.model.json.JSONModel();o.dataitems.sort(function(a,b){if(a.sorter<b.sorter){return 0;}else{return 1;}});g.setData(o);var i=this.GetGTINTableTemplate(g);i.attachPress({Entity:o,name:'matGtinDataDetail'},v.navtoSubDetail,v);t.setModel(g);t.bindItems('/dataitems',i,"",'');},GetNotesData:function(r,v){var N=[];var d=[];var D=[];var a=[];var b=[];var c=[];N=r.data.__batchResponses[0].data.MATERIAL2LONGTEXTSRel.results;if(N.length>0){for(var i=0;i<N.length;i++){if(N[i].TEXT_ID==="GRUN"){if(r.data.__batchResponses[0].data.MATERIAL2LONGTEXTSRel.results[i].LONGTEXT!==""){d.push(r.data.__batchResponses[0].data.MATERIAL2LONGTEXTSRel.results[i]);}}if(N[i].TEXT_ID==="IVER"){if(r.data.__batchResponses[0].data.MATERIAL2LONGTEXTSRel.results[i].LONGTEXT!==""){D.push(r.data.__batchResponses[0].data.MATERIAL2LONGTEXTSRel.results[i]);}}if(N[i].TEXT_ID==="DSCR"){if(r.data.__batchResponses[0].data.MATERIAL2LONGTEXTSRel.results[i].LONGTEXT!==""){a.push(r.data.__batchResponses[0].data.MATERIAL2LONGTEXTSRel.results[i]);}}if(N[i].TEXT_ID==="PRUE"){if(r.data.__batchResponses[0].data.MATERIAL2LONGTEXTSRel.results[i].LONGTEXT!==""){b.push(r.data.__batchResponses[0].data.MATERIAL2LONGTEXTSRel.results[i]);}}if(N[i].TEXT_ID==="BEST"){if(r.data.__batchResponses[0].data.MATERIAL2LONGTEXTSRel.results[i].LONGTEXT!==""){c.push(r.data.__batchResponses[0].data.MATERIAL2LONGTEXTSRel.results[i]);}}}if(d.length>0){var o={results:d};var t=sap.ui.getCore().byId("matNotesBasTxtTable");var g=new sap.ui.model.json.JSONModel();g.setData(o);t.setModel(g);var I=this.GetNotesTableTemplate(g);I.attachPress({Entity:r,name:'matNotesDetail',TableKey:"BasicTxt"},v.navtoSubDetail,v);t.bindItems('/results',I,'','');}else{sap.ui.getCore().byId("matNotesBasTxtTable").setVisible(false);}if(D.length>0){var O={results:D};var T=sap.ui.getCore().byId("matNotesIntComntTable");var G=new sap.ui.model.json.JSONModel();G.setData(O);T.setModel(G);var e=this.GetNotesTableTemplate(G);e.attachPress({Entity:r,name:'matNotesDetail',TableKey:"IntComnt"},v.navtoSubDetail,v);T.bindItems('/results',e,'','');}else{sap.ui.getCore().byId("matNotesIntComntTable").setVisible(false);}if(a.length>0){var s={results:a};var f=sap.ui.getCore().byId("matNotesDescTable");var h=new sap.ui.model.json.JSONModel();h.setData(s);f.setModel(h);var j=this.GetNotesTableTemplate(h);j.attachPress({Entity:r,name:'matNotesDetail',TableKey:"Descr"},v.navtoSubDetail,v);f.bindItems('/results',j,'','');}else{sap.ui.getCore().byId("matNotesDescTable").setVisible(false);}if(c.length>0){var k={results:c};var l=sap.ui.getCore().byId("matNotesPurchasingOrderTable");var m=new sap.ui.model.json.JSONModel();m.setData(k);l.setModel(m);var n=this.GetNotesTableTemplate(m);n.attachPress({Entity:r,name:'matNotesDetail',TableKey:"PurchOrderTxt"},v.navtoSubDetail,v);l.bindItems('/results',n,'','');}else{sap.ui.getCore().byId("matNotesPurchasingOrderTable").setVisible(false);}if(b.length>0){var p={results:b};var q=sap.ui.getCore().byId("matNotesQualityTable");var u=new sap.ui.model.json.JSONModel();u.setData(p);q.setModel(u);var w=this.GetNotesTableTemplate(u);w.attachPress({Entity:r,name:'matNotesDetail',TableKey:"Quality"},v.navtoSubDetail,v);q.bindItems('/results',w,'','');}else{sap.ui.getCore().byId("matNotesQualityTable").setVisible(false);}}else{var x=sap.ui.getCore().byId("matNotesPanel");this.setNoDataText(x,this.vNoDataTxt);}},getGtinoDataItems:function(q,u,a,b,c,d,e,h,f,g,i,s){var D;D={"quantity":q,"unitofmeasure":u,"unitofmeasure_txt":a,"basequantity":b,"baseunitofmeasure":c,"baseunitofmeasure_txt":d,"eanupc":e,"hpean":h,"eancategory":f,"eancategory_txt":g,"eanvariant":i,"sorter":s};return D;}};
