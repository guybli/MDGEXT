/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.require("sap.ca.scfld.md.controller.BaseDetailController");jQuery.sap.require("fcg.mdg.approvecrv2.util.Formatter");jQuery.sap.require("fcg.mdg.approvecrv2.util.DataAccess");jQuery.sap.require("fcg.mdg.approvecrv2.DomainSpecParts.Material.Material");jQuery.sap.require("fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialDocAssignmentCreate");jQuery.sap.require("fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialDocAssignmentChange");sap.ca.scfld.md.controller.BaseDetailController.extend("fcg.mdg.approvecrv2.view.MaterialDocAssignmentDetails",{oDocAssignmentDataDetails:"",os4view:null,vDocAssignment:"",vMaterial:"",RowId:0,sRowId:0,docNum:0,docType:"",docpart:"",docvs:"",result:"",isNavToDetail:"",oFileUpload:"",oS3Instance:"",vRouterName:"",extHookmatHookModifyDocRouting:null,i18n:sap.ca.scfld.md.app.Application.getImpl().getResourceBundle(),onInit:function(){sap.ca.scfld.md.controller.BaseDetailController.prototype.onInit.call(this);this.getView().byId("DocAssignmentDetail").setShowNavButton(true);this.oDataManager=sap.ca.scfld.md.app.Application.getImpl().getComponent().getDataManager();this.oRouter.attachRouteMatched(function(e){if(e.getParameter("name")==="matDocAssignmentDataDetail"){if(this.isNavToDetail!=="X"){this.vRouterName="matDocAssignmentDataDetail";this.RowId=e.getParameter('arguments').RowId;this.oS3Instance=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getS3Instance();var d=this.oS3Instance.getDecisions();this.oS3Instance.createDecisionButtons(d,this);this.setDocAssignmentHeader();this.getDocumentdata();this.loadDocAssignmentDetailLayout();this.getSetDocAssignmentDetails();this.setDocAssignmentObjHeader();}this.isNavToDetail="";}else if(e.getParameter("name")==="matDocAssignmentChangeDataDetail"){this.vRouterName="matDocAssignmentChangeDataDetail";this.RowId=e.getParameter('arguments').RowId;this.oS3Instance=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getS3Instance();var d=this.oS3Instance.getDecisions();this.oS3Instance.createDecisionButtons(d,this);var D=fcg.mdg.approvecrv2.util.Formatter.getDocAssignmentDetailHdr("Document Assignment");var c=this.getView().byId("DocAssignmentDetail").getCustomHeader();c.destroyContentMiddle();c.addContentMiddle(new sap.m.Text({text:D}));this.getDocumentdata();this.loadDocAssignmentDetailLayout();this.getSetDocAssignmentDetails();if(sap.ui.getCore().byId("MatDocAssignmentBtnPrev")!==undefined&&sap.ui.getCore().byId("MatDocAssignmentBtnNext")!==undefined){sap.ui.getCore().byId("MatDocAssignmentBtnPrev").setVisible(false);sap.ui.getCore().byId("MatDocAssignmentBtnNext").setVisible(false);}this.setDocAssignmentObjHeader();}this.matHookModifyDocRouting(this.vRoutername,this);},this);},matHookModifyDocRouting:function(r,v){if(this.extHookmatHookModifyDocRouting){this.extHookmatHookModifyDocRouting(r,v);}},loadDocAssignmentDetailLayout:function(){if(sap.ui.getCore().byId("Txt_Document")!==undefined){sap.ui.getCore().byId("Txt_Document").destroy();}if(this.oDocAssignmentDataDetails===""){this.oDocAssignmentDataDetails=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MaterialDocAssignmentDetails',fcg.mdg.approvecrv2.util.Formatter);}else{this.getView().byId("DocAssignmentDetail").removeContent(this.oDocAssignmentDataDetails);if(this.oDocAssignmentDataDetails!==undefined){this.oDocAssignmentDataDetails.destroy();}this.oDocAssignmentDataDetails=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MaterialDocAssignmentDetails',fcg.mdg.approvecrv2.util.Formatter);}this.getView().byId("DocAssignmentDetail").addContent(this.oDocAssignmentDataDetails);},setDocAssignmentHeader:function(){var d=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDocAssignmentDetailsData();var T=d.data.__batchResponses[0].data.MATERIAL2DRADBASICRel.results.length;this.sRowId=this.RowId;this.sRowId++;var c=this.getView().byId("DocAssignmentDetail").getCustomHeader();c.destroyContentMiddle();var D=fcg.mdg.approvecrv2.util.Formatter.getDocAssignmentDetailHdr("Document Assignment",this.sRowId,T);c.addContentMiddle(new sap.m.Text({text:D}));var v=this;if(sap.ui.getCore().byId("MatDocAssignmentBtnPrev")===undefined&&sap.ui.getCore().byId("MatDocAssignmentBtnNext")===undefined){c.addContentRight(new sap.m.Button({id:"MatDocAssignmentBtnPrev",icon:"sap-icon://up",press:function(){v.loadDocAssignmentDetailLayout();v.RowId--;v.getDocumentdata();v.getSetDocAssignmentDetails();v.setDocAssignmentObjHeader();v.setDocAssignmentHeader();}}));c.addContentRight(new sap.m.Button({id:"MatDocAssignmentBtnNext",icon:"sap-icon://down",press:function(){v.loadDocAssignmentDetailLayout();v.RowId++;v.getDocumentdata();v.getSetDocAssignmentDetails();v.setDocAssignmentObjHeader();v.setDocAssignmentHeader();}}));}sap.ui.getCore().byId("MatDocAssignmentBtnPrev").setVisible(true);sap.ui.getCore().byId("MatDocAssignmentBtnNext").setVisible(true);fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setMatIteratorVisibility(this.sRowId,sap.ui.getCore().byId("MatDocAssignmentBtnPrev"),sap.ui.getCore().byId("MatDocAssignmentBtnNext"),T);},setDocAssignmentObjHeader:function(){var d=this.i18n.getText("Mat_Document")+": "+this.docType+"/"+this.docNum;this.getView().byId("DocAssignmentDetailHeader").setTitle(d);var D=this.i18n.getText("Mat_Doc_Part_Vs")+": "+this.docvs+"/"+this.docpart;this.getView().byId("DocDHeader").setText(D);var g=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getGeneralDetailData();this.vMaterial=g.data.MATERIAL;var m=g.data.TXTMI;var M=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(this.vMaterial,m);M=this.i18n.getText("Material")+": "+M;this.getView().byId("MatrlHeader").setText(M);},getSetDocAssignmentDetails:function(){var d=this.results;fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialDocAssignmentCreate.getsetDocData(d,this);},navtoSubDetail:function(e,d){this.isNavToDetail="X";var p=e.getSource().getBindingContext().getPath();var r=p.substr(p.lastIndexOf("/")+1);var D=e.getSource().getBindingContext().getObject().DOKNR;var v=e.getSource().getBindingContext().getObject().DOKAR;var l=e.getSource().getBindingContext().getObject().LANGUCODE;if(d.name==="matDocAssignmentTextDataDetail"){this.oRouter.navTo("matDocAssignmentTextDataDetail",{RowId:r});}else if(d.name==="matDocAssignmentChangeTextDataDetail"){this.oRouter.navTo("matDocAssignmentChangeTextDataDetail",{RowId:r});}},getDocumentdata:function(){var d;if(this.vRouterName==="matDocAssignmentChangeDataDetail"){d=fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialDocAssignmentChange.getDocAssignmentData();this.docNum=d.dataitems[this.RowId].DOKNR;var D=d.dataitems[this.RowId].DOKAR;this.docvs=d.dataitems[this.RowId].DOKVR;this.docpart=d.dataitems[this.RowId].DOKTL;this.docType=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(d.dataitems[this.RowId].DOKAR,d.dataitems[this.RowId].DOKAR__TXT);}else if(this.vRouterName==="matDocAssignmentDataDetail"){d=fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialDocAssignmentCreate.getDocAssignmentData();this.docNum=d.dataitems[this.RowId].DOKNR;var D=d.dataitems[this.RowId].DOKAR;this.docvs=d.dataitems[this.RowId].DocumentVersion;this.docpart=d.dataitems[this.RowId].DocumentPart;this.docType=d.dataitems[this.RowId].DocumentType;}var a=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getDocAssignmentData(this.docNum,D,this.docvs,this.docpart);this.results=a;}});
