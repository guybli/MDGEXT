/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.require("sap.ca.scfld.md.controller.BaseDetailController");jQuery.sap.require("sap.ca.ui.message.message");jQuery.sap.require("sap.ca.ui.model.type.DateTime");jQuery.sap.require("fcg.mdg.approvecrv2.DomainSpecParts.Customer");jQuery.sap.require("fcg.mdg.approvecrv2.DomainSpecParts.CustomerChange");sap.ca.scfld.md.controller.BaseDetailController.extend("fcg.mdg.approvecrv2.view.DunningDetail",{compCode:"",subheader:"",oItemTemp:"",extHookModifyStyleClass:null,extHookdisplayDunningData:null,onInit:function(){var s="";var d="";var a="";var r="";this.getView().byId("dunningPage").setShowNavButton(true);this.oRouter.attachRouteMatched(function(e){if(e.getParameter("name")==="Dunning"){s=fcg.mdg.approvecrv2.DomainSpecParts.Customer.getS3Instance();d=s.getDecisions();s.createDecisionButtons(d,this,'navFromDetail');fcg.mdg.approvecrv2.util.Formatter.resetFormBolding(this.getView());a=e.getParameter("arguments");this.dunningarea=a.Key;r=fcg.mdg.approvecrv2.DomainSpecParts.Customer.getNavData();this.displayDunningData(r);if(this.extHookdisplayDunningData){this.extHookdisplayDunningData(r);}}if(e.getParameter("name")==="SuppDunning"){s=fcg.mdg.approvecrv2.DomainSpecParts.Supplier.getS3Instance();d=s.getDecisions();s.createDecisionButtons(d,this,'navFromDetail');fcg.mdg.approvecrv2.util.Formatter.resetFormBolding(this.getView());a=e.getParameter("arguments");this.dunningarea=a.Key;r=fcg.mdg.approvecrv2.DomainSpecParts.Supplier.getNavData();this.displaySuppDunningData(r);}},this);},displayDunningData:function(r){for(var i=0;i<r.results.length;i++){if(r.results.length>1){var a="";if(!this.isNull(r.results[i].CU_AssignedCustomerRel)){var c=r.results[i].CU_AssignedCustomerRel;if(!this.isNull(c.KTOKD)&&!this.isNull(c.KTOKD__TXT)){a=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(c.KTOKD,c.KTOKD__TXT);}}this.subheader=fcg.mdg.approvecrv2.DomainSpecParts.SupplierChange.getSubheaderWithAccGrp(r.results[i].STANDARD,r.results[i].OBJECT_ID,r.results[i].REASON_ID__TXT,a);}else{this.subheader="";}for(var j=0;j<r.results[i].CU_AssignedCompanyCodesRel.results.length;j++){var A=r.results[i].CU_AssignedCompanyCodesRel.results[j];for(var k=0;k<A.CU_CompDunningAreasRel.results.length;k++){var d=A.CU_CompDunningAreasRel.results[k];var b=d.BUKRS;var e=d.MABER;var f=d.ASSIGNMENT_ID+b+e;if(f===this.dunningarea){var g=A.BUKRS__TXT;g=this.getView().getModel("i18n").getProperty("GL_COMP_CODE")+": "+g+"("+b+")";var h="";if(d.MABER!==""){h=this.getView().getModel("i18n").getProperty("DunningArea")+": "+d.MABER__TXT+"("+d.MABER+")";}else{h=this.getView().getModel("i18n").getProperty("DunningArea")+": "+d.MABER__TXT;}if(h===this.getView().getModel("i18n").getProperty("DunningArea")+": "){h=this.getView().getModel("i18n").getProperty("DunningArea")+": "+sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("DefaultDunning");}this.getView().byId("dunObjHeaderDet").setTitle(h);this.getView().byId("erpCCDunning").setText(g);var m=fcg.mdg.approvecrv2.util.DataAccess.getObjectKey();this.getView().byId("bpdesc").setText(m);this.getView().byId("erpCustDunning").setText(this.subheader);var F=d;var M=new sap.ui.model.json.JSONModel();M.setData(F);var E=this.getView().byId("SimpleFormDunning");E.setModel(M);var s="text_bold";if(this.extHookModifyStyleClass){var n=this.extHookModifyStyleClass(s);if(n!==undefined){s=n;}}this.removeStyleClass(s);if(d.ChangeData.results!==undefined&&d.ChangeData.results.length>0){for(var l=0;l<d.ChangeData.results.length;l++){var L="lbl"+d.ChangeData.results[l].Attribute;var o=this.getView().byId(L);if(o!==undefined){o.setDesign("Bold");}var t=d.ChangeData.results[l].Attribute;if(this.getView().byId(t)!==undefined){this.getView().byId(t).addStyleClass(s);}}}}}}}},removeStyleClass:function(s){this.getView().byId("KNRMA").removeStyleClass(s);this.getView().byId("lblKNRMA").setDesign("Standard");this.getView().byId("BUSAB").removeStyleClass(s);this.getView().byId("lblBUSAB").setDesign("Standard");this.getView().byId("MANSP").removeStyleClass(s);this.getView().byId("lblMANSP").setDesign("Standard");this.getView().byId("MADAT").removeStyleClass(s);this.getView().byId("lblMADAT").setDesign("Standard");this.getView().byId("MAHNA").removeStyleClass(s);this.getView().byId("lblMAHNA").setDesign("Standard");this.getView().byId("GMVDT").removeStyleClass(s);this.getView().byId("lblGMVDT").setDesign("Standard");},displaySuppDunningData:function(r){for(var i=0;i<r.results.length;i++){if(r.results.length>1){var a="";if(r.results[i]!==undefined&&r.results[i].SP_AssignedSupplierRel.KTOKK!==undefined&&r.results[i].SP_AssignedSupplierRel.KTOKK__TXT!==undefined){var s=r.results[i].SP_AssignedSupplierRel;a=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(s.KTOKK,s.KTOKK__TXT);}this.subheader=fcg.mdg.approvecrv2.DomainSpecParts.SupplierChange.getSubheaderWithAccGrp(r.results[i].STANDARD,r.results[i].OBJECT_ID,r.results[i].REASON_ID__TXT,a);}else{this.subheader="";}for(var j=0;j<r.results[i].SP_AssignedCompanyCodesRel.results.length;j++){var A=r.results[i].SP_AssignedCompanyCodesRel.results[j];for(var k=0;k<A.SP_CompDunningAreasRel.results.length;k++){var d=A.SP_CompDunningAreasRel.results[k];var c=d.BUKRS;var b=d.MABER;var e=d.ASSIGNMENT_ID+c+b;if(e===this.dunningarea){var f=A.BUKRS__TXT;f=this.getView().getModel("i18n").getProperty("GL_COMP_CODE")+": "+f+"("+c+")";var g="";if(d.MABER!==""){g=this.getView().getModel("i18n").getProperty("DunningArea")+": "+d.MABER__TXT+"("+d.MABER+")";}else{g=this.getView().getModel("i18n").getProperty("DunningArea")+": "+d.MABER__TXT;}if(g===this.getView().getModel("i18n").getProperty("DunningArea")+": "){g=this.getView().getModel("i18n").getProperty("DunningArea")+": "+sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("DefaultDunning");}this.getView().byId("dunObjHeaderDet").setTitle(g);this.getView().byId("erpCCDunning").setText(f);var h=fcg.mdg.approvecrv2.util.DataAccess.getObjectKey();this.getView().byId("bpdesc").setText(h);this.getView().byId("erpCustDunning").setText(this.subheader);var F=d;var m=new sap.ui.model.json.JSONModel();m.setData(F);var E=this.getView().byId("SimpleFormDunning");E.setModel(m);var S="text_bold";this.removeStyleClass(S);if(d.ChangeData.results!==undefined&&d.ChangeData.results.length>0){for(var l=0;l<d.ChangeData.results.length;l++){var L="lbl"+d.ChangeData.results[l].Attribute;var o=this.getView().byId(L);if(o!==undefined){o.setDesign("Bold");}var t=d.ChangeData.results[l].Attribute;if(this.getView().byId(t)!==undefined){this.getView().byId(t).addStyleClass(S);}}}}}}}},isNull:function(v){return typeof v==="undefined"||v==="unknown"||v===null||v==="null"||parseInt(v)===0;}});
