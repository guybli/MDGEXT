/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.require("sap.ca.scfld.md.controller.BaseDetailController");jQuery.sap.require("fcg.mdg.approvecrv2.DomainSpecParts.Customer");jQuery.sap.require("fcg.mdg.approvecrv2.util.DataAccess");jQuery.sap.require("fcg.mdg.approvecrv2.util.Formatter");jQuery.sap.require("sap.fcg.mdg.lib.address.util.AddressLib");jQuery.sap.require("sap.fcg.mdg.lib.address.util.AddressFormatter");sap.ca.scfld.md.controller.BaseDetailController.extend("fcg.mdg.approvecrv2.view.Address",{vAddressDescription:"",vDomain:"",onInit:function(){var e="";var I="";var L=new sap.ui.model.resource.ResourceModel({bundleUrl:jQuery.sap.getModulePath("sap.fcg.mdg.lib.address")+"/i18n/i18n.properties"});L.setDefaultBindingMode(sap.ui.model.BindingMode.OneTime);this.getView().byId('AddressVl').setModel(L,"i18n");this.getView().getModel().setDefaultBindingMode("TwoWay");this.getView().byId("AddressPage").setShowNavButton(true);var m="";this.oRouter.attachRouteMatched(function(E){if(E.getParameter("name")==="AddressDetail"){var a="";var b="";var d="";var A=this.ChangeKey=E.getParameter('arguments').ChangeKey;this.vDomain=E.getParameter('arguments').Domain;m=new sap.ui.model.json.JSONModel();var r=fcg.mdg.approvecrv2.DomainSpecParts[this.vDomain].getData('General');var p=r[0].data.BP_Root.BP_AddressesRel;var c=r[0].data.BP_Root.CATEGORY;var P="";var h=this.getView().byId("addrObjHeaderDet");fcg.mdg.approvecrv2.util.Formatter.resetFormBolding(this.getView());this.getView().byId("addrAttrHeader").setText(fcg.mdg.approvecrv2.util.DataAccess.getObjectKey());fcg.mdg.approvecrv2.DomainSpecParts[this.vDomain].setRouter(this.oRouter);if(this.vDomain==='Customer'){this.oS3Instance=fcg.mdg.approvecrv2.DomainSpecParts.Customer.getS3Instance();d=this.oS3Instance.getDecisions();this.oS3Instance.createDecisionButtons(d,this,'navFromDetail');}if(this.vDomain==='Supplier'){this.oS3Instance=fcg.mdg.approvecrv2.DomainSpecParts.Supplier.getS3Instance();d=this.oS3Instance.getDecisions();this.oS3Instance.createDecisionButtons(d,this,'navFromDetail');}if(A.length>10)A=A.slice(0,10);A=A.split(" ")[0];for(var i=0;i<p.results.length;i++){if(p.results[i].AD_ID===A){P=p.results[i];}}h.setTitle(this.getView().getModel("i18n").getProperty("CC_ADDRESS")+": "+P.AD_ID__TXT);this.vAddressDescription=P.AD_ID__TXT;var f=P.COUNTRY;if(f==="US"||f==="CA"||f==="JP"){a=f;}m.setData(P);var v=this.getView().byId("AddressVl");v.destroyContent();switch(c){case"1":b="PERSON";break;}this.address_form=sap.fcg.mdg.lib.address.util.AddressLib.getDefaultAddressForm(this,a,b);v.addContent(this.address_form);v.setModel(m);if(P===""){return;}if(P.ChangeData.results!==undefined&&P.ChangeData.results!==null){if(P.ChangeData.results.length>0){var s="text_bold";for(var l=0;l<P.ChangeData.results.length;l++){var g="lbl"+P.ChangeData.results[l].Attribute;var o=sap.ui.getCore().byId(g);if(o!==undefined){o.setDesign("Bold");}var t="txt"+P.ChangeData.results[l].Attribute;if(sap.ui.getCore().byId(t)!==undefined){sap.ui.getCore().byId(t).addStyleClass(s);}}}}var u=P.BP_UsagesOfAddressRel;if(u.results!==undefined&&u.results.length!==0){for(var i=0;i<u.results.length;i++){if(u.results[i]!==undefined&&u.results[i].ADDRESSTYPE==="XXDEFAULT"){u.results[i].STANDARDADDRESSUSAGE='X';u.results[i].STANDARDADDRESSUSAGE__TXT='Yes';}}e=this.getView().byId("AddressUsages");e.setVisible(true);m=new sap.ui.model.json.JSONModel();m.setData(u);e.setModel(m);I=this.getAddrUsageTemplate(m);e.bindItems('/results',I,'','');}else{e=this.getView().byId("AddressUsages");e.setVisible(false);}var T=P.BP_CommPhoneRel;if(T.results!==undefined&&T.results.length!==0){e=this.getView().byId("TelephoneNumbers");e.setVisible(true);m=new sap.ui.model.json.JSONModel();m.setData(T);e.setModel(m);I=this.getTelTemplate(m);e.bindItems('/results',I,'','');}else{e=this.getView().byId("TelephoneNumbers");e.setVisible(false);}var M=P.BP_CommMobileRel;if(M.results!==undefined&&M.results.length!==0){e=this.getView().byId("MobileNumbers");e.setVisible(true);m=new sap.ui.model.json.JSONModel();m.setData(M);e.setModel(m);I=this.getMobileTemplate(m);e.bindItems('/results',I,'','');}else{e=this.getView().byId("MobileNumbers");e.setVisible(false);}var F=P.BP_CommFaxRel;if(F.results!==undefined&&F.results.length!==0){e=this.getView().byId("FaxNumbers");e.setVisible(true);m=new sap.ui.model.json.JSONModel();m.setData(F);e.setModel(m);I=this.getFaxTemplate(m);e.bindItems('/results',I,'','');}else{e=this.getView().byId("FaxNumbers");e.setVisible(false);}var j=P.BP_CommEMailRel;if(j.results!==undefined&&j.results.length!==0){e=this.getView().byId("EMailAddresses");e.setVisible(true);m=new sap.ui.model.json.JSONModel();m.setData(j);e.setModel(m);I=this.getEMailTemplate(m);e.bindItems('/results',I,'','');}else{e=this.getView().byId("EMailAddresses");e.setVisible(false);}var U=P.BP_CommURIRel;if(U.results!==undefined&&U.results.length!==0){e=this.getView().byId("URL");e.setVisible(true);m=new sap.ui.model.json.JSONModel();m.setData(U);e.setModel(m);I=this.getURLTemplate(m);e.bindItems('/results',I,'','');}else{e=this.getView().byId("URL");e.setVisible(false);}if(r[0].data.BP_Root.CATEGORY!=="1"){var k=P.BP_AddressVersionsOrgRel;if(k.results!==undefined&&k.results.length!==0){for(i=0;i<k.results.length;i++){k.results[i].Domain=this.vDomain;}e=this.getView().byId("IAV_O");e.setVisible(true);m=new sap.ui.model.json.JSONModel();m.setData(k);e.setModel(m);I=this.getIAVTemplate(m);I.attachPress({EntityData:k,EntityName:'IAVDetail',ChangeData:k},this.navtoIAVDetail,' ');e.bindItems('/results',I,'','');}else{e=this.getView().byId("IAV_O");e.setVisible(false);}this.getView().byId("IAV_P").setVisible(false);}else if(r[0].data.BP_Root.CATEGORY==="1"){var n=P.BP_AddressVersionsPersRel;if(n.results!==undefined&&n.results.length!==0){for(i=0;i<n.results.length;i++){n.results[i].Domain=this.vDomain;}e=this.getView().byId("IAV_P");e.setVisible(true);m=new sap.ui.model.json.JSONModel();m.setData(n);e.setModel(m);I=this.getIAVPersonTemplate(m);I.attachPress({EntityData:n,EntityName:'IAVPersDetail',ChangeData:n},this.navtoIAVDetail,' ');e.bindItems('/results',I,'','');}else{e=this.getView().byId("IAV_P");e.setVisible(false);}this.getView().byId("IAV_O").setVisible(false);}}},this);},PressBack:function(){var e=this.getView().byId("AddressVl");e.destroyContent();},getAddrUsageTemplate:function(m){var i=new sap.m.ColumnListItem({cells:[new sap.m.Text({text:{path:"ADDRESSTYPE",formatter:function(){fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"ADDRESSTYPE");var d=m.getProperty("ADDRESSTYPE__TXT",this.getBindingContext());var k=m.getProperty("ADDRESSTYPE",this.getBindingContext());return fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,d);}}}),new sap.m.Text({text:{path:"STANDARDADDRESSUSAGE",formatter:function(){fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"STANDARDADDRESSUSAGE");var s=m.getProperty("STANDARDADDRESSUSAGE",this.getBindingContext());if(s==="X")s=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText('PC_YES');else s=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText('PC_NO');return s;}}})]});return i;},getTelTemplate:function(m){var t=this;var i=new sap.m.ColumnListItem({cells:[new sap.m.Text({text:{path:"COUNTRY__TXT",formatter:function(){var d=m.getProperty("COUNTRY__TXT",this.getBindingContext());var k=m.getProperty("COUNTRY",this.getBindingContext());fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"COUNTRY");return fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,d);}}}),new sap.m.Text({text:{path:"TELEPHONE",formatter:function(){fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"TELEPHONE");return m.getProperty('TELEPHONE',this.getBindingContext());}}}),new sap.m.Text({text:{path:"EXTENSION",formatter:function(){var e=m.getProperty('EXTENSION',this.getBindingContext());fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"EXTENSION");if(t.isNull(e))return fcg.mdg.approvecrv2.util.Formatter.noValue("");return e;}}}),new sap.m.Text({text:{path:"STD_NO",formatter:function(){fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"STD_NO");var s=m.getProperty("STD_NO",this.getBindingContext());if(s==="X")s=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText('PC_YES');else s=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText('PC_NO');return s;}}})]});return i;},getMobileTemplate:function(m){var i=new sap.m.ColumnListItem({cells:[new sap.m.Text({text:{path:"COUNTRY__TXT",formatter:function(){var d=m.getProperty("COUNTRY__TXT",this.getBindingContext());var k=m.getProperty("COUNTRY",this.getBindingContext());fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"COUNTRY");return fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,d);}}}),new sap.m.Text({text:{path:"TELEPHONE",formatter:function(){fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"TELEPHONE");return m.getProperty('TELEPHONE',this.getBindingContext());}}}),new sap.m.Text({text:{path:"STD_NO",formatter:function(){fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"STD_NO");var s=m.getProperty("STD_NO",this.getBindingContext());if(s==="X")s=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText('PC_YES');else s=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText('PC_NO');return s;}}})]});return i;},getFaxTemplate:function(m){var t=this;var i=new sap.m.ColumnListItem({cells:[new sap.m.Text({text:{path:"COUNTRY__TXT",formatter:function(){var d=m.getProperty("COUNTRY__TXT",this.getBindingContext());var k=m.getProperty("COUNTRY",this.getBindingContext());fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"COUNTRY");return fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,d);}}}),new sap.m.Text({text:{path:"FAX",formatter:function(){fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"FAX");return m.getProperty('FAX',this.getBindingContext());}}}),new sap.m.Text({text:{path:"EXTENSION",formatter:function(){var e=m.getProperty('EXTENSION',this.getBindingContext());fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"EXTENSION");if(t.isNull(e))return fcg.mdg.approvecrv2.util.Formatter.noValue("");return e;}}}),new sap.m.Text({text:{path:"STD_NO",formatter:function(){fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"STD_NO");var s=m.getProperty("STD_NO",this.getBindingContext());if(s==="X")s=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText('PC_YES');else s=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText('PC_NO');return s;}}})]});return i;},getEMailTemplate:function(m){var i=new sap.m.ColumnListItem({cells:[new sap.m.Text({text:{path:"E_MAIL",formatter:function(){fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"E_MAIL");return m.getProperty('E_MAIL',this.getBindingContext());}}}),new sap.m.Text({text:{path:"STD_NO",formatter:function(){fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"STD_NO");var s=m.getProperty("STD_NO",this.getBindingContext());if(s==="X")s=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText('PC_YES');else s=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText('PC_NO');return s;}}})]});return i;},getURLTemplate:function(m){var i=new sap.m.ColumnListItem({cells:[new sap.m.Text({text:{path:"URI",formatter:function(){fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"URI");return m.getProperty('URI',this.getBindingContext());}}}),new sap.m.Text({text:{path:"STD_NO",formatter:function(){fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"STD_NO");var s=m.getProperty("STD_NO",this.getBindingContext());if(s==="X")s=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText('PC_YES');else s=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText('PC_NO');return s;}}})]});return i;},getIAVTemplate:function(m){var t=this;var i=new sap.m.ColumnListItem({type:"Navigation",cells:[new sap.m.Text({text:{path:"ADDR_VERS",formatter:function(){fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"ADDR_VERS");return m.getProperty("ADDR_VERS__TXT",this.getBindingContext());}}}),new sap.m.Text({text:{path:"NAME",formatter:function(){var n=m.getProperty('NAME',this.getBindingContext());fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"NAME");if(t.isNull(n))return fcg.mdg.approvecrv2.util.Formatter.noValue("");return n;}}}),new sap.m.Text({text:{path:"AD_ID",formatter:function(){fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"AD_ID");return m.getProperty("AD_ID__TXT",this.getBindingContext());}}})]});return i;},getIAVPersonTemplate:function(m){var t=this;var i=new sap.m.ColumnListItem({type:"Navigation",cells:[new sap.m.Text({text:{path:"ADDR_VERS",formatter:function(){var d=m.getProperty("ADDR_VERS__TXT",this.getBindingContext());var k=m.getProperty("ADDR_VERS",this.getBindingContext());fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"ADDR_VERS");return fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,d);}}}),new sap.m.Text({text:{path:"BP_AddressPersonVersionRel/FIRSTNAME",formatter:function(){var n=m.getProperty('BP_AddressPersonVersionRel/FIRSTNAME',this.getBindingContext());fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"BP_AddressPersonVersionRel/FIRSTNAME");if(t.isNull(n))return fcg.mdg.approvecrv2.util.Formatter.noValue("");return n;}}}),new sap.m.Text({text:{path:"BP_AddressPersonVersionRel/LASTNAME",formatter:function(){var l=m.getProperty('BP_AddressPersonVersionRel/LASTNAME',this.getBindingContext());fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"BP_AddressPersonVersionRel/LASTNAME");if(t.isNull(l))return fcg.mdg.approvecrv2.util.Formatter.noValue("");return l;}}}),new sap.m.Text({text:{path:"AD_ID",formatter:function(){var a=m.getProperty("AD_ID__TXT",this.getBindingContext());fcg.mdg.approvecrv2.util.Formatter.handleCellBolding(this,m,"AD_ID");if(t.isNull(a))return fcg.mdg.approvecrv2.util.Formatter.noValue("");return a;}}})]});return i;},checkBox:function(v){var n="";if(v==="X")n=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_CHECK_BOX_SET");else n=sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("CC_CHECK_BOX_RESET");return n;},navtoIAVDetail:function(e){this.bindingContext=e.getSource("listItem").getBindingContext();if(this.bindingContext!==undefined)this.sPath=e.getSource("listItem").getBindingContext().sPath;else{this.bindingContext=e.getParameter("listItem").getBindingContext();this.sPath=e.getParameter("listItem").getBindingContext().sPath;}var p="";p=this.sPath.split("/");var E=this.bindingContext.oModel.oData.results[p[2]];var a=E.ADDR_VERS;var A=E.AD_ID;var v=E.Domain;this.oRouter=fcg.mdg.approvecrv2.DomainSpecParts[v].getRouter();if(A!==""){if(fcg.mdg.approvecrv2.DomainSpecParts[v].getData('General')[0].data.BP_Root.CATEGORY==="2"||fcg.mdg.approvecrv2.DomainSpecParts[v].getData('General')[0].data.BP_Root.CATEGORY==="3"){this.oRouter.navTo("IAVDetail",{AddressId:A,AddressVersion:a,Domain:v});}else if(fcg.mdg.approvecrv2.DomainSpecParts[v].getData('General')[0].data.BP_Root.CATEGORY==="1"){this.oRouter.navTo("IAVPersDetail",{AddressId:A,AddressVersion:a,Domain:v});}}},isNull:function(v){return typeof v==="undefined"||v==='unknown'||v===null||v==='null'||v===''||parseInt(v)===0;}});
