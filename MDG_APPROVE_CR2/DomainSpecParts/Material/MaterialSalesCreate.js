/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.declare("fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialSalesCreate");jQuery.sap.require("fcg.mdg.approvecrv2.DomainSpecParts.Material.Material");jQuery.sap.require("fcg.mdg.approvecrv2.util.DataAccess");fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialSalesCreate={oMaterialCreateForm:"",oMaterialPlantTable:"",oMaterialPlantForm:"",oMaterialSalesForm:"",flag:0,oSalesTableForm:"",aSales:"",aSalesDetailData:"",i18n:sap.ca.scfld.md.app.Application.getImpl().getResourceBundle(),oSalesTableS4Details:"",oS3View:"",oSalesOrgView:"",aSalesdata:"",SalesOrgHeaderTxt:"",aSalesTaxTextData:"",vNoDataTxt:"",SalesOrg:"",DChannel:"",initialize_SalesForms:function(s){this.oS3Controller=s;this.vNoDataTxt=this.i18n.getText("NodataCreate");if(this.oMaterialSalesForm===""){this.oMaterialSalesForm=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MaterialSalesCreate',fcg.mdg.approvecrv2.util.Formatter);}else{this.oMaterialSalesForm.destroy();this.oMaterialSalesForm=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MaterialSalesCreate',fcg.mdg.approvecrv2.util.Formatter);}sap.ui.getCore().byId("matCreateSalesDataLayout").removeAllContent();sap.ui.getCore().byId("matCreateSalesDataLayout").addContent(this.oMaterialSalesForm);if(sap.ui.getCore().byId("matChangeSalesDataLayout")!==undefined){sap.ui.getCore().byId("matChangeSalesDataLayout").destroy();}},displaySalesFormData:function(r){var c=r.MSTDV;r.MSTDV=fcg.mdg.approvecrv2.util.Formatter.matDateFormat(c);var d=new sap.ui.model.json.JSONModel();d.setData(r);sap.ui.getCore().byId("matSalesDataForm").setModel(d);},bindSalesTableData:function(r,v){this.flag=0;var t=sap.ui.getCore().byId("MatSalesDistChainTable");var i="/results";this.aSalesdata=r.data.MATERIAL2MVKESALESRel;if(this.aSalesdata.results.length>1){this.flag=1;var d=new sap.ui.model.json.JSONModel();d.setData(this.aSalesdata);var D=sap.ui.getCore().byId("DisbChainpersIcon");fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setTablePersonalization(i,t,D);var I=this.createSalesDisTemplate(d);I.attachPress({Entity:r,name:'matSalesDataDetail'},v.navtoSubDetail,v);t.setModel(d);t.bindItems('/results',I,'','');}else if(this.aSalesdata.results.length===1){this.flag=2;if(t!==undefined){t.destroy();}this.loadSalesOrgForm();var s=sap.ui.getCore().byId("MatSalestaxTable");var S=sap.ui.getCore().byId("SalesTaxpersIcon");fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setTablePersonalization(i,s,S);this.getSalesDetailData(0);var a=this.setGetSalesObjHeader(0);sap.ui.getCore().byId("Txt_SALESORG").setText(this.SalesOrg);sap.ui.getCore().byId("Txt_DISTCHANNEL").setText(this.DChannel);this.bindSalesOrgData();this.hideSalesOrgDetailSection();sap.ui.getCore().byId("matSalesCreateLayout").addContent(this.oSalesTableForm);}else{if(t!==undefined){t.destroy();}}this.hideSalesSection();},loadSalesOrgForm:function(){if(this.oSalesTableForm===""){if(this.oSalesTableS4Details!==""){this.oSalesTableS4Details.destroy();}this.oSalesTableForm=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MatSalesOrgDetails',fcg.mdg.approvecrv2.util.Formatter);}else{if(this.oSalesTableForm!==undefined){this.oSalesTableForm.destroy();}if(this.oSalesTableS4Details!==""){this.oSalesTableS4Details.destroy();}this.oSalesTableForm=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MatSalesOrgDetails',fcg.mdg.approvecrv2.util.Formatter);}sap.ui.getCore().byId("matSalesCreateLayout").removeContent(this.oSalesTableForm);sap.ui.getCore().byId("matSalesCreateLayout").addContent(this.oSalesTableForm);},bindSalesOrgData:function(){var d=new sap.ui.model.json.JSONModel();var v=this.aSalesDetailData.VMSTD;this.aSalesDetailData.VMSTD=fcg.mdg.approvecrv2.util.Formatter.matDateFormat(v);d.setData(this.aSalesDetailData);var e=sap.ui.getCore().byId("matSalesCreateLayout");this.bindSalesTaxTextData(this.aSalesTaxTextData);e.setModel(d);},getSalesDetailData:function(r){fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getSalesTableData(r);this.aSalesDetailData=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getSalesDetailData();this.aSalesTaxTextData=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getSalesTaxData();if(this.aSalesDetailData.data.MATERIAL===undefined){this.aSalesDetailData=this.aSalesDetailData.data.__batchResponses[0].data;}else{this.aSalesDetailData=this.aSalesDetailData.data;}return this.aSalesDetailData;},bindSalesTaxTextData:function(r){this.data=r.data.MVKESALES2MLANSALESRel;this.textData=r.data.MVKESALES2SALESTXTRel;var s=sap.ui.getCore().byId("MatSalestaxTable");var S=sap.ui.getCore().byId("MatSalestextTable");if(this.data.results.length>=1){var d=new sap.ui.model.json.JSONModel();d.setData(this.data);var I=this.createSalesTaxTemplate(d);s.setModel(d);s.bindItems('/results',I,'','');}else{s.destroy();}if(this.textData.results.length>=1){this.oS3View=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getS3Instance();for(var i=0;i<this.textData.results.length;i++){for(var j=0;j<this.textData.results.length;){if(this.textData.results[j].TXTSALES===""){for(var k=j;k<this.textData.results.length-1;k++){this.textData.results[k].TXTSALES=this.textData.results[k+1].TXTSALES;this.textData.results[k].LANGUCODE=this.textData.results[k+1].LANGUCODE;this.textData.results[k].LANGUCODE__TXT=this.textData.results[k+1].LANGUCODE__TXT;}this.textData.results.length=this.textData.results.length-1;}else{j++;}}}var t=new sap.ui.model.json.JSONModel();t.setData(this.textData);var o=this.createSalesTextTemplate(t);this.oSalesOrgView=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getMatSalesOrgInstance();if(this.aSalesdata.results.length>1){o.attachPress({Entity:r,name:'matSalesTextDetail'},this.oSalesOrgView.navtoSubDetail,this.oSalesOrgView);S.setModel(t);S.bindItems('/results',o,'','');}else{o.attachPress({Entity:r,name:'matSalesTextDetail'},this.oS3View.navtoSubDetail,this.oS3View);S.setModel(t);S.bindItems('/results',o,'','');}}else{S.destroy();}},createSalesTaxTemplate:function(d){var i=new sap.m.ColumnListItem({cells:[new sap.m.Text({text:{path:'ALAND',formatter:function(){var a=d.getProperty("ALAND__TXT",this.getBindingContext());var k=d.getProperty("ALAND",this.getBindingContext());if(k===""){return fcg.mdg.approvecrv2.util.Formatter.noValue(k);}else{return fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,a);}}}}),new sap.m.Text({text:{path:'TATYP',formatter:function(){var a=d.getProperty("TATYP__TXT",this.getBindingContext());var k=d.getProperty("TATYP",this.getBindingContext());if(k===""){return fcg.mdg.approvecrv2.util.Formatter.noValue(k);}else{return fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,a);}}}}),new sap.m.Text({text:{path:'TAXSALTAX',formatter:function(){var a=d.getProperty("TAXSALTAX__TXT",this.getBindingContext());var k=d.getProperty("TAXSALTAX",this.getBindingContext());if(k===""){return fcg.mdg.approvecrv2.util.Formatter.noValue(k);}else{return fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,a);}}}})]});var e=this.oS3Controller.matHookgetSalesTaxTemplate(i);if(e!==undefined){i=e;}return i;},createSalesTextTemplate:function(t){var o=new sap.m.ColumnListItem({type:"Navigation",cells:[new sap.m.Text({text:{path:'LANGUCODE',formatter:function(){var d=t.getProperty("LANGUCODE__TXT",this.getBindingContext());var k=t.getProperty("LANGUCODE",this.getBindingContext());if(k===""){return fcg.mdg.approvecrv2.util.Formatter.noValue(k);}else{return fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,d);}}}}),new sap.m.Text({text:{path:"TXTSALES",formatter:function(){var d=t.getProperty("TXTSALES",this.getBindingContext());return fcg.mdg.approvecrv2.util.Formatter.Truncate(d);}}})]});var e=this.oS3Controller.matHookgetSalesTextTemplate(o);if(e!==undefined){o=e;}return o;},createSalesDisTemplate:function(d){var i=new sap.m.ColumnListItem({type:"Navigation",cells:[new sap.m.Text({text:{path:'VKORG',formatter:function(){var a=d.getProperty("VKORG__TXT",this.getBindingContext());var k=d.getProperty("VKORG",this.getBindingContext());if(k===""){return fcg.mdg.approvecrv2.util.Formatter.noValue(k);}else{return fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,a);}}}}),new sap.m.Text({text:{path:'VTWEG',formatter:function(){var a=d.getProperty("VTWEG__TXT",this.getBindingContext());var k=d.getProperty("VTWEG",this.getBindingContext());if(k===""){return fcg.mdg.approvecrv2.util.Formatter.noValue(k);}else{return fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(k,a);}}}})]});var e=this.oS3Controller.matHookgetSalesDistChainsTemplate(i);if(e!==undefined){i=e;}return i;},setGetSalesObjHeader:function(R){var d=this.i18n.getText("SL_DIST_CHN");var s=this.i18n.getText("Sl_Org");var D=this.i18n.getText("Distribution");if(this.aSalesdata.results.length===1){R=0;}this.SalesOrg=s+": "+this.aSalesdata.results[R].VKORG__TXT+" ("+this.aSalesdata.results[R].VKORG+")";this.DChannel=D+": "+this.aSalesdata.results[R].VTWEG__TXT+" ("+this.aSalesdata.results[R].VTWEG+")";this.SalesOrgHeaderTxt=d+": "+this.aSalesdata.results[R].VKORG__TXT+" ("+this.aSalesdata.results[R].VKORG+")/"+this.aSalesdata.results[R].VTWEG__TXT+" ("+this.aSalesdata.results[R].VTWEG+")";return this.SalesOrgHeaderTxt;},getSalesDataLen:function(){return this.aSalesdata.results.length;},hideSalesSection:function(){if(sap.ui.getCore().byId("Txt_TRAGR").getVisible()===false&&sap.ui.getCore().byId("MatSalesShip")!==undefined){sap.ui.getCore().byId("MatSalesShip").destroy();}this.oS3Controller=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getS3Instance();if(!this.oS3Controller.matHookHideSalesPackagingSection()){if(sap.ui.getCore().byId("Txt_ERGEW").getVisible()===false&&sap.ui.getCore().byId("Txt_GEWTO").getVisible()===false&&sap.ui.getCore().byId("Txt_ERVOL").getVisible()===false&&sap.ui.getCore().byId("Txt_VOLTO").getVisible()===false&&sap.ui.getCore().byId("Txt_KZGVH").getVisible()===false&&sap.ui.getCore().byId("Txt_VHART").getVisible()===false&&sap.ui.getCore().byId("Txt_STFAK").getVisible()===false&&sap.ui.getCore().byId("MatSalesPackMtr")!==undefined){sap.ui.getCore().byId("MatSalesPackMtr").destroy();}}if(sap.ui.getCore().byId("MatSalesShip")===undefined&&sap.ui.getCore().byId("MatSalesPackMtr")===undefined){if(sap.ui.getCore().byId("matSalesDataForm")!==undefined){sap.ui.getCore().byId("matSalesDataForm").destroy();}}if(sap.ui.getCore().byId("matSalesDataForm")===undefined&&sap.ui.getCore().byId("MatSalesDistChainTable")===undefined){var n=sap.ui.getCore().byId("matSalesCreateLayout");fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialCreate.setNoDataText(n,this.vNoDataTxt);}},hideSalesOrgDetailSection:function(){if(sap.ui.getCore().byId("Txt_VRKME").getText()===""&&sap.ui.getCore().byId("Txt_MEGSALES").getText()===""&&sap.ui.getCore().byId("Txt_VMSTA").getText()===""&&sap.ui.getCore().byId("Txt_WRKSALES").getText()===""&&sap.ui.getCore().byId("Txt_SKTOF").getText()===""&&sap.ui.getCore().byId("MatSalesGenData")!==undefined){sap.ui.getCore().byId("MatSalesGenData").destroy();}if(sap.ui.getCore().byId("Txt_AUMNG").getText()==="0.000"&&sap.ui.getCore().byId("Txt_LFMNG").getText()==="0.000"&&sap.ui.getCore().byId("Txt_EFMNG").getText()==="0.000"&&sap.ui.getCore().byId("Txt_SCMNG").getText()==="0.000 "&&sap.ui.getCore().byId("Txt_RDPSALES").getText()===""&&sap.ui.getCore().byId("MatSalesQnty")!==undefined){sap.ui.getCore().byId("MatSalesQnty").destroy();}if(sap.ui.getCore().byId("Txt_PRAT1").getText()===""&&sap.ui.getCore().byId("Txt_PRAT1").getText()===""&&sap.ui.getCore().byId("Txt_PRAT2").getText()===""&&sap.ui.getCore().byId("Txt_PRAT3").getText()===""&&sap.ui.getCore().byId("Txt_PRAT4").getText()===""&&sap.ui.getCore().byId("Txt_PRAT5").getText()===""&&sap.ui.getCore().byId("Txt_PRAT6").getText()===""&&sap.ui.getCore().byId("Txt_PRAT7").getText()===""&&sap.ui.getCore().byId("Txt_PRAT8").getText()===""&&sap.ui.getCore().byId("Txt_PRAT9").getText()===""&&sap.ui.getCore().byId("Txt_PRATA").getText()===""&&sap.ui.getCore().byId("MatSalesProdAttr")!==undefined){sap.ui.getCore().byId("MatSalesProdAttr").destroy();}if(sap.ui.getCore().byId("Txt_VAVME").getVisible()===false&&sap.ui.getCore().byId("matSalesSubSection")!==undefined){sap.ui.getCore().byId("matSalesSubSection").destroy();}if(sap.ui.getCore().byId("MatSalesGenData")===undefined&&sap.ui.getCore().byId("MatSalesQnty")===undefined&&sap.ui.getCore().byId("MatSalesProdAttr")===undefined&&sap.ui.getCore().byId("matSalesSubSection")===undefined){if(sap.ui.getCore().byId("matSalesMainSection")!==undefined){sap.ui.getCore().byId("matSalesMainSection").destroy();}}if(sap.ui.getCore().byId("matSalesMainSection")===undefined){if(sap.ui.getCore().byId("matSalesTableS4Form")!==undefined){sap.ui.getCore().byId("matSalesTableS4Form").destroy();}}if(sap.ui.getCore().byId("Txt_VERSG").getText()===""&&sap.ui.getCore().byId("Txt_BONUS").getText()===""&&sap.ui.getCore().byId("Txt_PROVG").getText()===""&&sap.ui.getCore().byId("Txt_PMATN").getText()===""&&sap.ui.getCore().byId("Txt_KONDM").getText()===""&&sap.ui.getCore().byId("Txt_PRODH").getText()===""&&sap.ui.getCore().byId("Txt_KTGRM").getText()===""&&sap.ui.getCore().byId("Txt_MTPOS").getText()===""&&sap.ui.getCore().byId("matSalesGrouping")!==undefined){sap.ui.getCore().byId("matSalesGrouping").destroy();}if(sap.ui.getCore().byId("Txt_MVGR1").getText()===""&&sap.ui.getCore().byId("Txt_MVGR2").getText()===""&&sap.ui.getCore().byId("Txt_MVGR3").getText()===""&&sap.ui.getCore().byId("Txt_MVGR4").getText()===""&&sap.ui.getCore().byId("Txt_MVGR5").getText()===""&&sap.ui.getCore().byId("Mat")!==undefined){sap.ui.getCore().byId("Mat").destroy();}if(sap.ui.getCore().byId("matSalesGrouping")===undefined&&sap.ui.getCore().byId("Mat")===undefined){if(sap.ui.getCore().byId("grp")!==undefined){sap.ui.getCore().byId("grp").destroy();}}if(sap.ui.getCore().byId("grp")===undefined){if(sap.ui.getCore().byId("matSalesTableS4Form2")!==undefined){sap.ui.getCore().byId("matSalesTableS4Form2").destroy();}}},setNoDataText:function(i){var o=new sap.m.List();o.setNoDataText(sap.ca.scfld.md.app.Application.getImpl().getResourceBundle().getText("NodataCreate"));i.destroyContent();i.addContent(o);}};
