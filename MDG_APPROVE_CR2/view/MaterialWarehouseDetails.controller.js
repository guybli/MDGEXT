/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.require("sap.ca.scfld.md.controller.BaseDetailController");jQuery.sap.require("sap.m.TablePersoController");jQuery.sap.require("fcg.mdg.approvecrv2.util.Formatter");jQuery.sap.require("fcg.mdg.approvecrv2.util.DataAccess");jQuery.sap.require("fcg.mdg.approvecrv2.DomainSpecParts.Material.Material");jQuery.sap.require("fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate");jQuery.sap.require("fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseChange");sap.ca.scfld.md.controller.BaseDetailController.extend("fcg.mdg.approvecrv2.view.MaterialWarehouseDetails",{oWarehouseDataDetails:"",vWarehouse:"",vMaterial:"",RowId:0,sRowId:0,result:"",isNavToDetail:"",oS3Instance:"",oDecisions:"",aWhChangedDetailData:"",oStorageType:"",extHookmatHookModifyWarehouseRouting:null,vSWarehouseNum:"",vStorageType:"",req:"",mat:"",wh:"",vCreated:"",vTotalWarehouses:"",vMatkeyDesc:"",aWarehouseGeneralData:"",aWarehouseDetailData:"",i18n:sap.ca.scfld.md.app.Application.getImpl().getResourceBundle(),onInit:function(){sap.ca.scfld.md.controller.BaseDetailController.prototype.onInit.call(this);this.getView().byId("WarehouseDetail").setShowNavButton(true);this.oS3Instance=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getS3Instance();this.aDecisions=this.oS3Instance.getDecisions();this.req=this.i18n.getText("DETAIL_TITLE");this.mat=this.i18n.getText("MATERIAL");this.wh=this.i18n.getText("Warehouse");this.vCreated=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getCreateEntityAction();this.oRouter.attachRouteMatched(function(e){switch(e.getParameter("name")){case"matWarehouseDataDetail":this.loadWarehouseDetailLayout();this.RowId=e.getParameter('arguments').RowId;this.aWarehouseGeneralData=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getWarehouseCreateData();this.bindWarehouseDetailData();var s=sap.ui.getCore().byId("MatWarehouseStorageTypeTable");var S=sap.ui.getCore().byId("StorageTypepersIcon");var i="/results";fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setTablePersonalization(i,s,S);this.setRowIdAndWarehouse();this.oS3Instance.createDecisionButtons(this.aDecisions,this);this.setWarehouseHeader();break;case"matWarehouseChangeDataDetail":if(this.isNavToDetail!=="X"){this.aWhChangedDetailData=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getWarehouseChangedData();this.loadWarehouseDetailLayout();this.vWarehouseNum=e.getParameter('arguments').LGNUM;this.vMatkeyDesc=fcg.mdg.approvecrv2.util.DataAccess.getObjectKey();var w=this.req+": "+this.mat+" - "+this.wh;this.getView().byId("WarehouseDetail").setTitle(w);fcg.mdg.approvecrv2.util.Formatter.resetFormBolding(this.getView());this.bindWarehouseChangedDetailData();var c=sap.ui.getCore().byId("MatWarehouseStorageTypeTable");var C=sap.ui.getCore().byId("StorageTypepersIcon");var o="/results";fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setTablePersonalization(o,c,C);this.oS3Instance.createDecisionButtons(this.aDecisions,this);if(sap.ui.getCore().byId("MatWarehouseBtnPrev")!==undefined&&sap.ui.getCore().byId("MatWarehouseBtnNext")!==undefined){sap.ui.getCore().byId("MatWarehouseBtnPrev").setVisible(false);sap.ui.getCore().byId("MatWarehouseBtnNext").setVisible(false);}}break;case"matStorageTypeChangeDataDetail":if(this.isNavToDetail!=="X"){this.aWhChangedDetailData=fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.getWarehouseChangedData();this.loadStorageTypeDetailLayout();var a=this.i18n.getText("Mat_Warehouse_StorageType");var b=this.req+": "+this.mat+" - "+this.wh+" - "+a;this.getView().byId("WarehouseDetail").setTitle(b);this.vSWarehouseNum=e.getParameter('arguments').LGNUM;this.vStorageType=e.getParameter('arguments').LGTYP;this.vSWarehouseDesc=e.getParameter('arguments').LGNUM__TXT;this.vStorageTypeDesc=e.getParameter('arguments').LGTYP__TXT;fcg.mdg.approvecrv2.util.Formatter.resetFormBolding(this.getView());this.oS3Instance.createDecisionButtons(this.aDecisions,this);var m=fcg.mdg.approvecrv2.util.DataAccess.getObjectKey();this.setStorageTypeObjHeader(this.vSWarehouseDesc,this.vStorageTypeDesc,m);if(sap.ui.getCore().byId("MatWarehouseBtnPrev")!==undefined&&sap.ui.getCore().byId("MatWarehouseBtnNext")!==undefined){sap.ui.getCore().byId("MatWarehouseBtnPrev").setVisible(false);sap.ui.getCore().byId("MatWarehouseBtnNext").setVisible(false);}this.bindStorageTypeChangedDetailData();}break;}this.isNavToDetail="";this.matHookModifyWarehouseRouting(e.getParameter("name"),this);},this);},matHookModifyWarehouseRouting:function(r,v){if(this.extHookmatHookModifyWarehouseRouting){this.extHookmatHookModifyWarehouseRouting(r,v);}},loadWarehouseDetailLayout:function(){if(this.oWarehouseDataDetails!==undefined&&this.oWarehouseDataDetails!==""){this.getView().byId("WarehouseDetail").removeContent(this.oWarehouseDataDetails);try{this.oWarehouseDataDetails.destroy();}catch(e){}}if(fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.oMaterialWarehouseForm===""){fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.oMaterialWarehouseForm=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MaterialWarehouseDetails',fcg.mdg.approvecrv2.util.Formatter);}else{this.getView().byId("WarehouseDetail").removeContent(fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.oMaterialWarehouseForm);if(fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.oMaterialWarehouseForm!==undefined){try{fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.oMaterialWarehouseForm.destroy();}catch(e){}}fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.oMaterialWarehouseForm=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MaterialWarehouseDetails',fcg.mdg.approvecrv2.util.Formatter);}this.getView().byId("WarehouseDetail").addContent(fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.oMaterialWarehouseForm);try{sap.ui.getCore().byId("Txt_WAREHOUSEDETAILS").setVisible(false);}catch(e){}},loadStorageTypeDetailLayout:function(){if(fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.oMaterialWarehouseForm!==undefined&&fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.oMaterialWarehouseForm!==""){this.getView().byId("WarehouseDetail").removeContent(fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.oMaterialWarehouseForm);try{fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.oMaterialWarehouseForm.destroy();}catch(e){}}if(this.oWarehouseDataDetails===""){this.oWarehouseDataDetails=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MaterialStorageTypeChange',fcg.mdg.approvecrv2.util.Formatter);}else{this.getView().byId("WarehouseDetail").removeContent(this.oWarehouseDataDetails);if(this.oWarehouseDataDetails!==undefined){try{this.oWarehouseDataDetails.destroy();}catch(e){}}this.oWarehouseDataDetails=sap.ui.xmlfragment('fcg.mdg.approvecrv2.frag.Material.MaterialStorageTypeChange',fcg.mdg.approvecrv2.util.Formatter);}this.getView().byId("WarehouseDetail").addContent(this.oWarehouseDataDetails);},bindWarehouseDetailData:function(){this.aWarehouseDetailData=fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.getWarehouseDetailData(this.RowId);var d=new sap.ui.model.json.JSONModel();if(this.aWarehouseDetailData.L2SKR===""){this.aWarehouseDetailData.L2SKR=this.aWarehouseDetailData.L2SKR__TXT;this.aWarehouseDetailData.L2SKR__TXT="";}if(this.aWarehouseDetailData.VOMEM===""){this.aWarehouseDetailData.VOMEM=this.aWarehouseDetailData.VOMEM__TXT;this.aWarehouseDetailData.VOMEM__TXT="";}d.setData(this.aWarehouseDetailData);var e=this.getView().byId("WarehouseDetail");this.aWarehouseStorageTypeData=this.aWarehouseDetailData.MLGNSTOR2MLGTSTORRel;fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.bindStorageTypeData(this.aWarehouseStorageTypeData);e.setModel(d);fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.hideWarehouseSection();},setWarehouseHeader:function(){var c=this.getView().byId("WarehouseDetail").getCustomHeader();c.destroyContentMiddle();var W=fcg.mdg.approvecrv2.util.Formatter.getWarehouseDetailHdr(this.i18n.getText("Warehouse"),this.sRowId,this.vTotalWarehouses);c.addContentMiddle(new sap.m.Text({text:W}));var v=this;if(sap.ui.getCore().byId("MatWarehouseBtnPrev")===undefined&&sap.ui.getCore().byId("MatWarehouseBtnNext")===undefined){c.addContentRight(new sap.m.Button({id:"MatWarehouseBtnPrev",icon:"sap-icon://up",press:function(){v.loadWarehouseDetailLayout();v.RowId--;v.setRowIdAndWarehouse();v.setWarehouseHeader();fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setMatIteratorVisibility(v.sRowId,sap.ui.getCore().byId("MatWarehouseBtnPrev"),sap.ui.getCore().byId("MatWarehouseBtnNext"),v.vTotalWarehouses);v.bindWarehouseDetailData();}}));c.addContentRight(new sap.m.Button({id:"MatWarehouseBtnNext",icon:"sap-icon://down",press:function(){v.loadWarehouseDetailLayout();v.RowId++;v.setRowIdAndWarehouse();v.setWarehouseHeader();fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setMatIteratorVisibility(v.sRowId,sap.ui.getCore().byId("MatWarehouseBtnPrev"),sap.ui.getCore().byId("MatWarehouseBtnNext"),v.vTotalWarehouses);v.bindWarehouseDetailData();}}));}fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setMatIteratorVisibility(this.sRowId,sap.ui.getCore().byId("MatWarehouseBtnPrev"),sap.ui.getCore().byId("MatWarehouseBtnNext"),this.vTotalWarehouses);this.getView().byId("WarehouseDetail").setTitle(this.WarehouseDetailsTitle);var w=this.aWarehouseGeneralData.results[this.RowId].LGNUM;var a=this.aWarehouseGeneralData.results[this.RowId].LGNUM__TXT;var m=fcg.mdg.approvecrv2.util.DataAccess.getObjectKey();this.setWarehouseObjHeader(w,a,m);},setRowIdAndWarehouse:function(){this.sRowId=this.RowId;this.sRowId++;this.vTotalWarehouses=this.aWarehouseGeneralData.results.length;},setWarehouseObjHeader:function(w,W,m){var v=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(w,W);v=this.i18n.getText("Warehouse")+": "+v;this.getView().byId("MatWarehouseMainHeader").setTitle(v);var M=this.i18n.getText("Material")+": "+m;this.getView().byId("MatrlWarehouseHeader").setText(M);},setStorageTypeObjHeader:function(w,s,m){m=this.i18n.getText("MATERIAL")+": "+m;this.vStorageTypeDesc=this.i18n.getText("Mat_Warehouse_StorageType")+": "+this.vStorageTypeDesc;this.vSWarehouseDesc=this.i18n.getText("Warehouse")+": "+this.vSWarehouseDesc;this.getView().byId("MatWarehouseMainHeader").setTitle(this.vStorageTypeDesc);this.getView().byId("MatWarehouseSubHeader").setText(this.vSWarehouseDesc);this.getView().byId("MatrlWarehouseHeader").setText(m);},setBoldWarehouseData:function(r){var s="text_bold";for(var j=0;j<r.ChangeData.results.length;j++){if(r.ChangeData.results[j].Attribute==="LHME1"){if(sap.ui.getCore().byId("LBL_LHMG1")!==undefined){sap.ui.getCore().byId("LBL_LHMG1").setDesign("Bold");}if(sap.ui.getCore().byId("Txt_LHMG1")!==undefined){sap.ui.getCore().byId("Txt_LHMG1").addStyleClass(s);}}if(r.ChangeData.results[j].Attribute==="LHME2"){if(sap.ui.getCore().byId("LBL_LHMG2")!==undefined){sap.ui.getCore().byId("LBL_LHMG2").setDesign("Bold");}if(sap.ui.getCore().byId("Txt_LHMG2")!==undefined){sap.ui.getCore().byId("Txt_LHMG2").addStyleClass(s);}}if(r.ChangeData.results[j].Attribute==="LHME3"){if(sap.ui.getCore().byId("LBL_LHMG3")!==undefined){sap.ui.getCore().byId("LBL_LHMG3").setDesign("Bold");}if(sap.ui.getCore().byId("Txt_LHMG3")!==undefined){sap.ui.getCore().byId("Txt_LHMG3").addStyleClass(s);}}if(r.ChangeData.results[j].Attribute==="BEZME"){if(sap.ui.getCore().byId("LBL_MKAPV")!==undefined){sap.ui.getCore().byId("LBL_MKAPV").setDesign("Bold");}if(sap.ui.getCore().byId("Txt_MKAPV")!==undefined){sap.ui.getCore().byId("Txt_MKAPV").addStyleClass(s);}}var l="LBL_"+r.ChangeData.results[j].Attribute;var L=sap.ui.getCore().byId(l);if(L!==undefined){L.setDesign("Bold");}var t="Txt_"+r.ChangeData.results[j].Attribute;if(sap.ui.getCore().byId(t)!==undefined){sap.ui.getCore().byId(t).addStyleClass(s);}}},bindStorageTypeData:function(r){var s=new sap.ui.model.json.JSONModel();s.setData(r.MLGNSTOR2MLGTSTORRel);var S=sap.ui.getCore().byId("MatWarehouseStorageTypeTable");var o=fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.getStorageTypeTableTemplate("",s,this.oS3Instance,r.ChangeData.results[0].EntityAction);S.setModel(s);S.bindItems('/results',o,'','');},onClickPrevious:function(){this.loadWarehouseDetailLayout();this.RowId--;this.setRowIdAndWarehouse();fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setMatIteratorVisibility(this.sRowId,this.getView().byId("MatWarehouseBtnPrev"),this.getView().byId("MatWarehouseBtnNext"),this.vTotalWarehouses);this.setWarehouseHeader();this.bindWarehouseDetailData();},onClickNext:function(){this.loadWarehouseDetailLayout();this.RowId++;this.setRowIdAndWarehouse();fcg.mdg.approvecrv2.DomainSpecParts.Material.Material.setMatIteratorVisibility(this.sRowId,this.getView().byId("MatWarehouseBtnPrev"),this.getView().byId("MatWarehouseBtnNext"),this.vTotalWarehouses);this.setWarehouseHeader();this.bindWarehouseDetailData();},bindWarehouseChangedDetailData:function(){var w=new sap.ui.model.json.JSONModel();var W=sap.ui.getCore().byId("matWarehouseDataForm");var a=this.aWhChangedDetailData.results;var b;for(var i=0;i<a.length;i++){b=a[i].ChangeData.results;if(a[i].LGNUM===this.vWarehouseNum){var v=a[i].LGNUM__TXT;this.setWarehouseObjHeader(this.vWarehouseNum,v,this.vMatkeyDesc);this.getView().byId("MatWarehouseSubHeader").setText("");if(b[0].EntityAction!==this.vCreated){this.setBoldWarehouseData(a[i]);}if(a[i].L2SKR===""){a[i].L2SKR=a[i].L2SKR__TXT;a[i].L2SKR__TXT="";}if(a[i].VOMEM===""){a[i].VOMEM=a[i].VOMEM__TXT;a[i].VOMEM__TXT="";}this.bindStorageTypeData(a[i]);w.setData(a[i]);W.setModel(w);fcg.mdg.approvecrv2.DomainSpecParts.Material.MaterialWarehouseCreate.hideWarehouseSection();return;}}},bindStorageTypeChangedDetailData:function(){var s=new sap.ui.model.json.JSONModel();var S=sap.ui.getCore().byId("matStorageTypeChangeForm");var w=this.aWhChangedDetailData.results;var a;for(var i=0;i<w.length;i++){a=w[i].MLGNSTOR2MLGTSTORRel.results;for(var j=0;j<a.length;j++){if(a[j].LGNUM===this.vSWarehouseNum&&a[j].LGTYP===this.vStorageType){if(a[j].ChangeData.results[0].EntityAction!=="C"){this.setBoldWarehouseData(a[j]);}s.setData(a[j]);S.setModel(s);return;}}}}});
