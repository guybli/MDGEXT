/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.require("sap.ca.scfld.md.controller.BaseDetailController");jQuery.sap.require("sap.ca.ui.message.message");jQuery.sap.require("sap.ca.ui.model.type.DateTime");jQuery.sap.require("fcg.mdg.approvecrv2.DomainSpecParts.Customer");jQuery.sap.require("fcg.mdg.approvecrv2.DomainSpecParts.CustomerChange");sap.ca.scfld.md.controller.BaseDetailController.extend("fcg.mdg.approvecrv2.view.ExtendedTaxDetail",{compCode:"",oItemTemp:"",subheader:"",extHookdisplayWithhldTaxData:null,extHookModifyStyleClass:null,onInit:function(){this.getView().byId("ExtendedTaxPage").setShowNavButton(true);var s=fcg.mdg.approvecrv2.DomainSpecParts.Customer.getS3Instance();var d=s.getDecisions();s.createDecisionButtons(d,this,'navFromDetail');this.oRouter.attachRouteMatched(function(e){if(e.getParameter("name")==="Withhldtax"){fcg.mdg.approvecrv2.util.Formatter.resetFormBolding(this.getView());var a=e.getParameter("arguments");this.withtax=a.Key;var r=fcg.mdg.approvecrv2.DomainSpecParts.Customer.getNavData();this.displayWithhldTaxData(r);if(this.extHookdisplayWithhldTaxData){this.extHookdisplayWithhldTaxData(r);}}},this);},displayWithhldTaxData:function(r){var n="";var s="";for(var i=0;i<r.results.length;i++){if(r.results.length>1){var a="";if(!this.isNull(r.results[i].CU_AssignedCustomerRel)){var c=r.results[i].CU_AssignedCustomerRel;if(!this.isNull(c.KTOKD)&&!this.isNull(c.KTOKD__TXT)){a=fcg.mdg.approvecrv2.util.Formatter.getKeyDesc(c.KTOKD,c.KTOKD__TXT);}}this.subheader=fcg.mdg.approvecrv2.DomainSpecParts.CustomerCreate.getSubheaderWithAccGrp(r.results[i].STANDARD,r.results[i].OBJECT_ID,r.results[i].REASON_ID__TXT,a);}else{this.subheader="";}for(var j=0;j<r.results[i].CU_AssignedCompanyCodesRel.results.length;j++){var A=r.results[i].CU_AssignedCompanyCodesRel.results[j];for(var k=0;k<A.CU_CompWithholdingTaxesRel.results.length;k++){var C=A.CU_CompWithholdingTaxesRel.results[k];var b=C.BUKRS;var w=C.WITHT;var d=C.ASSIGNMENT_ID+b+w;if(d===this.withtax){var e=A.BUKRS__TXT;e=e+"("+b+")";var f=C.WITHT__TXT;var o=f+"("+w+")";this.getView().byId("exTaxObjHeaderDet").setTitle(o);this.getView().byId("erpCompCode").setText(e);var g=fcg.mdg.approvecrv2.util.DataAccess.getObjectKey();this.getView().byId("bpdesc").setText(g);this.getView().byId("erpCustTax").setText(this.subheader);var F=C;var m=new sap.ui.model.json.JSONModel();m.setData(F);var E=this.getView().byId("SimpleFormExTax");E.setModel(m);s="text_bold";if(this.extHookModifyStyleClass){n=this.extHookModifyStyleClass(s);if(n!==undefined){s=n;}}this.removeStyleClass(s);if(C.ChangeData.results!==undefined&&C.ChangeData.results.length>0){s="text_bold";for(var l=0;l<C.ChangeData.results.length;l++){var L="lbl"+C.ChangeData.results[l].Attribute;var h=this.getView().byId(L);if(h!==undefined){h.setDesign("Bold");}var t=C.ChangeData.results[l].Attribute;if(this.getView().byId(t)!==undefined){this.getView().byId(t).addStyleClass(s);}}}}}}}},removeStyleClass:function(s){this.getView().byId("WT_WTSTCD").removeStyleClass(s);this.getView().byId("lblWT_WTSTCD").setDesign("Standard");this.getView().byId("WT_AGTDF").removeStyleClass(s);this.getView().byId("lblWT_AGTDF").setDesign("Standard");this.getView().byId("WT_WITHCD").removeStyleClass(s);this.getView().byId("lblWT_WITHCD").setDesign("Standard");this.getView().byId("WT_AGENT").removeStyleClass(s);this.getView().byId("lblWT_AGENT").setDesign("Standard");this.getView().byId("WT_AGTDT").removeStyleClass(s);this.getView().byId("lblWT_AGTDT").setDesign("Standard");},isNull:function(v){return typeof v==="undefined"||v==='unknown'||v===null||v==='null'||parseInt(v)===0;}});
